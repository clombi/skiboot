<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - skiboot-tul169-boot.info - include/processor.h</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">include</a> - processor.h<span style="font-size: 80%;"> (source / <a href="processor.h.func.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">skiboot-tul169-boot.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">7</td>
            <td class="headerCovTableEntry">10</td>
            <td class="headerCovTableEntryLo">70.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2015-02-25</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntryHi">-</td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">           Branch data     Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>                :            : /* Copyright 2013-2014 IBM Corp.</a>
<span class="lineNum">       2 </span>                :            :  *
<span class="lineNum">       3 </span>                :            :  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
<span class="lineNum">       4 </span>                :            :  * you may not use this file except in compliance with the License.
<span class="lineNum">       5 </span>                :            :  * You may obtain a copy of the License at
<span class="lineNum">       6 </span>                :            :  *
<span class="lineNum">       7 </span>                :            :  *      http://www.apache.org/licenses/LICENSE-2.0
<span class="lineNum">       8 </span>                :            :  *
<span class="lineNum">       9 </span>                :            :  * Unless required by applicable law or agreed to in writing, software
<span class="lineNum">      10 </span>                :            :  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
<span class="lineNum">      11 </span>                :            :  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
<span class="lineNum">      12 </span>                :            :  * implied.
<span class="lineNum">      13 </span>                :            :  * See the License for the specific language governing permissions and
<span class="lineNum">      14 </span>                :            :  * limitations under the License.
<span class="lineNum">      15 </span>                :            :  */
<span class="lineNum">      16 </span>                :            : 
<span class="lineNum">      17 </span>                :            : #ifndef __PROCESSOR_H
<span class="lineNum">      18 </span>                :            : #define __PROCESSOR_H
<span class="lineNum">      19 </span>                :            : 
<span class="lineNum">      20 </span>                :            : #include &lt;bitutils.h&gt;
<span class="lineNum">      21 </span>                :            : 
<span class="lineNum">      22 </span>                :            : /* P7 MSR bits */
<span class="lineNum">      23 </span>                :            : #define MSR_SF          PPC_BIT(0)      /* 64-bit mode */
<span class="lineNum">      24 </span>                :            : #define MSR_HV          PPC_BIT(3)      /* Hypervisor mode */
<span class="lineNum">      25 </span>                :            : #define MSR_VEC         PPC_BIT(38)     /* VMX enable */
<span class="lineNum">      26 </span>                :            : #define MSR_VSX         PPC_BIT(40)     /* VSX enable */
<span class="lineNum">      27 </span>                :            : #define MSR_EE          PPC_BIT(48)     /* External Int. Enable */
<span class="lineNum">      28 </span>                :            : #define MSR_PR          PPC_BIT(49)             /* Problem state */
<span class="lineNum">      29 </span>                :            : #define MSR_FP          PPC_BIT(50)     /* Floating Point Enable */
<span class="lineNum">      30 </span>                :            : #define MSR_ME          PPC_BIT(51)     /* Machine Check Enable */
<span class="lineNum">      31 </span>                :            : #define MSR_FE0         PPC_BIT(52)     /* FP Exception 0 */
<span class="lineNum">      32 </span>                :            : #define MSR_SE          PPC_BIT(53)     /* Step enable */
<span class="lineNum">      33 </span>                :            : #define MSR_BE          PPC_BIT(54)     /* Branch trace enable */
<span class="lineNum">      34 </span>                :            : #define MSR_FE1         PPC_BIT(55)     /* FP Exception 1 */
<span class="lineNum">      35 </span>                :            : #define MSR_IR          PPC_BIT(58)     /* Instructions reloc */
<span class="lineNum">      36 </span>                :            : #define MSR_DR          PPC_BIT(59)     /* Data reloc */
<span class="lineNum">      37 </span>                :            : #define MSR_PMM         PPC_BIT(61)     /* Perf Monitor */
<span class="lineNum">      38 </span>                :            : #define MSR_RI          PPC_BIT(62)     /* Recoverable Interrupt */
<span class="lineNum">      39 </span>                :            : #define MSR_LE          PPC_BIT(63)     /* Little Endian */
<span class="lineNum">      40 </span>                :            : 
<span class="lineNum">      41 </span>                :            : /* PIR */
<span class="lineNum">      42 </span>                :            : #define SPR_PIR_P8_THREAD_MASK  0x0007  /* Mask of thread bits */
<span class="lineNum">      43 </span>                :            : #define SPR_PIR_P8_MASK         0x1fff  /* Mask of implemented bits */
<span class="lineNum">      44 </span>                :            : #define SPR_PIR_P7_THREAD_MASK  0x0003  /* Mask of thread bits */
<span class="lineNum">      45 </span>                :            : #define SPR_PIR_P7_MASK         0x03ff  /* Mask of implemented bits */
<span class="lineNum">      46 </span>                :            : 
<span class="lineNum">      47 </span>                :            : /* SPR register definitions */
<span class="lineNum">      48 </span>                :            : #define SPR_DSISR       0x012   /* RW: Data storage interrupt status reg */
<span class="lineNum">      49 </span>                :            : #define SPR_DAR         0x013   /* RW: Data address reg */
<span class="lineNum">      50 </span>                :            : #define SPR_SDR1        0x019
<span class="lineNum">      51 </span>                :            : #define SPR_SRR0        0x01a   /* RW: Exception save/restore reg 0 */
<span class="lineNum">      52 </span>                :            : #define SPR_SRR1        0x01b   /* RW: Exception save/restore reg 1 */
<span class="lineNum">      53 </span>                :            : #define SPR_CFAR        0x01c   /* RW: Come From Address Register */
<span class="lineNum">      54 </span>                :            : #define SPR_TBRL        0x10c   /* RO: Timebase low */
<span class="lineNum">      55 </span>                :            : #define SPR_TBRU        0x10d   /* RO: Timebase high */
<span class="lineNum">      56 </span>                :            : #define SPR_SPRC        0x114   /* RW: Access to uArch SPRs (ex SCOMC) */
<span class="lineNum">      57 </span>                :            : #define SPR_SPRD        0x115   /* RW: Access to uArch SPRs (ex SCOMD) */
<span class="lineNum">      58 </span>                :            : #define SPR_SCOMC       0x114   /* RW: SCOM Control - old name of SPRC */
<span class="lineNum">      59 </span>                :            : #define SPR_SCOMD       0x115   /* RW: SCOM Data    - old name of SPRD */
<span class="lineNum">      60 </span>                :            : #define SPR_TBWL        0x11c   /* RW: Timebase low */
<span class="lineNum">      61 </span>                :            : #define SPR_TBWU        0x11d   /* RW: Timebase high */
<span class="lineNum">      62 </span>                :            : #define SPR_TBU40       0x11e   /* RW: Timebase Upper 40 bit */
<span class="lineNum">      63 </span>                :            : #define SPR_PVR         0x11f   /* RO: Processor version register */
<span class="lineNum">      64 </span>                :            : #define SPR_HSPRG0      0x130   /* RW: Hypervisor scratch 0 */
<span class="lineNum">      65 </span>                :            : #define SPR_HSPRG1      0x131   /* RW: Hypervisor scratch 1 */
<span class="lineNum">      66 </span>                :            : #define SPR_HSRR0       0x13a   /* RW: HV Exception save/restore reg 0 */
<span class="lineNum">      67 </span>                :            : #define SPR_HSRR1       0x13b   /* RW: HV Exception save/restore reg 1 */
<span class="lineNum">      68 </span>                :            : #define SPR_TFMR        0x13d
<span class="lineNum">      69 </span>                :            : #define SPR_LPCR        0x13e
<span class="lineNum">      70 </span>                :            : #define SPR_HMER        0x150   /* Hypervisor Maintenance Exception */
<span class="lineNum">      71 </span>                :            : #define SPR_HMEER       0x151   /* HMER interrupt enable mask */
<span class="lineNum">      72 </span>                :            : #define SPR_AMOR        0x15d
<span class="lineNum">      73 </span>                :            : #define SPR_TSCR        0x399
<span class="lineNum">      74 </span>                :            : #define SPR_HID0        0x3f0
<span class="lineNum">      75 </span>                :            : #define SPR_HID1        0x3f1
<span class="lineNum">      76 </span>                :            : #define SPR_HID2        0x3f8
<span class="lineNum">      77 </span>                :            : #define SPR_HID4        0x3f4
<span class="lineNum">      78 </span>                :            : #define SPR_HID5        0x3f6
<span class="lineNum">      79 </span>                :            : #define SPR_PIR         0x3ff   /* RO: Processor Identification */
<span class="lineNum">      80 </span>                :            : 
<span class="lineNum">      81 </span>                :            : /* Bits in LPCR */
<span class="lineNum">      82 </span>                :            : 
<span class="lineNum">      83 </span>                :            : /* Powersave Exit Cause Enable is different for P7 and P8 */
<span class="lineNum">      84 </span>                :            : #define SPR_LPCR_P7_PECE        PPC_BITMASK(49,51)
<span class="lineNum">      85 </span>                :            : #define SPR_LPCR_P7_PECE0       PPC_BIT(49)   /* Wake on external interrupts */
<span class="lineNum">      86 </span>                :            : #define SPR_LPCR_P7_PECE1       PPC_BIT(50)   /* Wake on decrementer */
<span class="lineNum">      87 </span>                :            : #define SPR_LPCR_P7_PECE2       PPC_BIT(51)   /* Wake on MCs, HMIs, etc... */
<span class="lineNum">      88 </span>                :            : 
<span class="lineNum">      89 </span>                :            : #define SPR_LPCR_P8_PECE        PPC_BITMASK(47,51)
<span class="lineNum">      90 </span>                :            : #define SPR_LPCR_P8_PECE0       PPC_BIT(47)   /* Wake on priv doorbell */
<span class="lineNum">      91 </span>                :            : #define SPR_LPCR_P8_PECE1       PPC_BIT(48)   /* Wake on hv doorbell */
<span class="lineNum">      92 </span>                :            : #define SPR_LPCR_P8_PECE2       PPC_BIT(49)   /* Wake on external interrupts */
<span class="lineNum">      93 </span>                :            : #define SPR_LPCR_P8_PECE3       PPC_BIT(50)   /* Wake on decrementer */
<span class="lineNum">      94 </span>                :            : #define SPR_LPCR_P8_PECE4       PPC_BIT(51)   /* Wake on MCs, HMIs, etc... */
<span class="lineNum">      95 </span>                :            : 
<span class="lineNum">      96 </span>                :            : 
<span class="lineNum">      97 </span>                :            : /* Bits in TFMR - control bits */
<span class="lineNum">      98 </span>                :            : #define SPR_TFMR_MAX_CYC_BET_STEPS      PPC_BITMASK(0,7)
<span class="lineNum">      99 </span>                :            : #define SPR_TFMR_N_CLKS_PER_STEP        PPC_BITMASK(8,9)
<span class="lineNum">     100 </span>                :            : #define SPR_TFMR_MASK_HMI               PPC_BIT(10)
<span class="lineNum">     101 </span>                :            : #define SPR_TFMR_SYNC_BIT_SEL           PPC_BITMASK(11,13)
<span class="lineNum">     102 </span>                :            : #define SPR_TFMR_TB_ECLIPZ              PPC_BIT(14)
<span class="lineNum">     103 </span>                :            : #define SPR_TFMR_LOAD_TOD_MOD           PPC_BIT(16)
<span class="lineNum">     104 </span>                :            : #define SPR_TFMR_MOVE_CHIP_TOD_TO_TB    PPC_BIT(18)
<span class="lineNum">     105 </span>                :            : #define SPR_TFMR_CLEAR_TB_ERRORS        PPC_BIT(24)
<span class="lineNum">     106 </span>                :            : /* Bits in TFMR - thread indep. status bits */
<span class="lineNum">     107 </span>                :            : #define SPR_TFMR_HDEC_PARITY_ERROR      PPC_BIT(26)
<span class="lineNum">     108 </span>                :            : #define SPR_TFMR_TBST_CORRUPT           PPC_BIT(27)
<span class="lineNum">     109 </span>                :            : #define SPR_TFMR_TBST_ENCODED           PPC_BITMASK(28,31)
<span class="lineNum">     110 </span>                :            : #define SPR_TFMR_TBST_LAST              PPC_BITMASK(32,35)
<span class="lineNum">     111 </span>                :            : #define SPR_TFMR_TB_ENABLED             PPC_BIT(40)
<span class="lineNum">     112 </span>                :            : #define SPR_TFMR_TB_VALID               PPC_BIT(41)
<span class="lineNum">     113 </span>                :            : #define SPR_TFMR_TB_SYNC_OCCURED        PPC_BIT(42)
<span class="lineNum">     114 </span>                :            : #define SPR_TFMR_TB_MISSING_SYNC        PPC_BIT(43)
<span class="lineNum">     115 </span>                :            : #define SPR_TFMR_TB_MISSING_STEP        PPC_BIT(44)
<span class="lineNum">     116 </span>                :            : #define SPR_TFMR_TB_RESIDUE_ERR         PPC_BIT(45)
<span class="lineNum">     117 </span>                :            : #define SPR_TFMR_FW_CONTROL_ERR         PPC_BIT(46)
<span class="lineNum">     118 </span>                :            : #define SPR_TFMR_CHIP_TOD_STATUS        PPC_BITMASK(47,50)
<span class="lineNum">     119 </span>                :            : #define SPR_TFMR_CHIP_TOD_INTERRUPT     PPC_BIT(51)
<span class="lineNum">     120 </span>                :            : #define SPR_TFMR_CHIP_TOD_TIMEOUT       PPC_BIT(54)
<span class="lineNum">     121 </span>                :            : #define SPR_TFMR_CHIP_TOD_PARITY_ERR    PPC_BIT(56)
<span class="lineNum">     122 </span>                :            : /* Bits in TFMR - thread specific. status bits */
<span class="lineNum">     123 </span>                :            : #define SPR_TFMR_PURR_PARITY_ERR        PPC_BIT(57)
<span class="lineNum">     124 </span>                :            : #define SPR_TFMR_SPURR_PARITY_ERR       PPC_BIT(58)
<span class="lineNum">     125 </span>                :            : #define SPR_TFMR_DEC_PARITY_ERR         PPC_BIT(59)
<span class="lineNum">     126 </span>                :            : #define SPR_TFMR_TFMR_CORRUPT           PPC_BIT(60)
<span class="lineNum">     127 </span>                :            : #define SPR_TFMR_PURR_OVERFLOW          PPC_BIT(61)
<span class="lineNum">     128 </span>                :            : #define SPR_TFMR_SPURR_OVERFLOW         PPC_BIT(62)
<span class="lineNum">     129 </span>                :            : 
<span class="lineNum">     130 </span>                :            : /* Bits in HMER/HMEER */
<span class="lineNum">     131 </span>                :            : #define SPR_HMER_MALFUNCTION_ALERT      PPC_BIT(0)
<span class="lineNum">     132 </span>                :            : #define SPR_HMER_PROC_RECV_DONE         PPC_BIT(2)
<span class="lineNum">     133 </span>                :            : #define SPR_HMER_PROC_RECV_ERROR_MASKED PPC_BIT(3)
<span class="lineNum">     134 </span>                :            : #define SPR_HMER_TFAC_ERROR             PPC_BIT(4)
<span class="lineNum">     135 </span>                :            : #define SPR_HMER_TFMR_PARITY_ERROR      PPC_BIT(5)
<span class="lineNum">     136 </span>                :            : #define SPR_HMER_XSCOM_FAIL             PPC_BIT(8)
<span class="lineNum">     137 </span>                :            : #define SPR_HMER_XSCOM_DONE             PPC_BIT(9)
<span class="lineNum">     138 </span>                :            : #define SPR_HMER_PROC_RECV_AGAIN        PPC_BIT(11)
<span class="lineNum">     139 </span>                :            : #define SPR_HMER_WARN_RISE              PPC_BIT(14)
<span class="lineNum">     140 </span>                :            : #define SPR_HMER_WARN_FALL              PPC_BIT(15)
<span class="lineNum">     141 </span>                :            : #define SPR_HMER_SCOM_FIR_HMI           PPC_BIT(16)
<span class="lineNum">     142 </span>                :            : #define SPR_HMER_TRIG_FIR_HMI           PPC_BIT(17)
<span class="lineNum">     143 </span>                :            : #define SPR_HMER_HYP_RESOURCE_ERR       PPC_BIT(20)
<span class="lineNum">     144 </span>                :            : #define SPR_HMER_XSCOM_STATUS           PPC_BITMASK(21,23)
<span class="lineNum">     145 </span>                :            : 
<span class="lineNum">     146 </span>                :            : /*
<span class="lineNum">     147 </span>                :            :  * HMEER: initial bits for HMI interrupt enable mask.
<span class="lineNum">     148 </span>                :            :  * Per Dave Larson, never enable 8,9,21-23
<span class="lineNum">     149 </span>                :            :  */
<span class="lineNum">     150 </span>                :            : #define SPR_HMEER_HMI_ENABLE_MASK       (SPR_HMER_MALFUNCTION_ALERT |\
<span class="lineNum">     151 </span>                :            :                                          SPR_HMER_HYP_RESOURCE_ERR |\
<span class="lineNum">     152 </span>                :            :                                          SPR_HMER_PROC_RECV_DONE |\
<span class="lineNum">     153 </span>                :            :                                          SPR_HMER_PROC_RECV_ERROR_MASKED |\
<span class="lineNum">     154 </span>                :            :                                          SPR_HMER_TFAC_ERROR |\
<span class="lineNum">     155 </span>                :            :                                          SPR_HMER_TFMR_PARITY_ERROR |\
<span class="lineNum">     156 </span>                :            :                                          SPR_HMER_PROC_RECV_AGAIN)
<span class="lineNum">     157 </span>                :            : 
<span class="lineNum">     158 </span>                :            : /* Bits in HID0 */
<span class="lineNum">     159 </span>                :            : #define SPR_HID0_HILE                   PPC_BIT(19)
<span class="lineNum">     160 </span>                :            : #define SPR_HID0_ENABLE_ATTN            PPC_BIT(31)
<span class="lineNum">     161 </span>                :            : 
<span class="lineNum">     162 </span>                :            : /* PVR bits */
<span class="lineNum">     163 </span>                :            : #define SPR_PVR_TYPE                    0xffff0000
<span class="lineNum">     164 </span>                :            : #define SPR_PVR_VERS_MAJ                0x00000f00
<span class="lineNum">     165 </span>                :            : #define SPR_PVR_VERS_MIN                0x000000ff
<span class="lineNum">     166 </span>                :            : 
<span class="lineNum">     167 </span>                :            : #define PVR_TYPE(_pvr)          GETFIELD(SPR_PVR_TYPE, _pvr)
<span class="lineNum">     168 </span>                :            : #define PVR_VERS_MAJ(_pvr)      GETFIELD(SPR_PVR_VERS_MAJ, _pvr)
<span class="lineNum">     169 </span>                :            : #define PVR_VERS_MIN(_pvr)      GETFIELD(SPR_PVR_VERS_MIN, _pvr)
<span class="lineNum">     170 </span>                :            : 
<span class="lineNum">     171 </span>                :            : /* PVR definitions */
<span class="lineNum">     172 </span>                :            : #define PVR_TYPE_P7     0x003f
<span class="lineNum">     173 </span>                :            : #define PVR_TYPE_P7P    0x004a
<span class="lineNum">     174 </span>                :            : #define PVR_TYPE_P8E    0x004b /* Murano */
<span class="lineNum">     175 </span>                :            : #define PVR_TYPE_P8     0x004d /* Venice */
<span class="lineNum">     176 </span>                :            : 
<span class="lineNum">     177 </span>                :            : #ifdef __ASSEMBLY__
<span class="lineNum">     178 </span>                :            : 
<span class="lineNum">     179 </span>                :            : /* Thread priority control opcodes */
<span class="lineNum">     180 </span>                :            : #define smt_low         or 1,1,1
<span class="lineNum">     181 </span>                :            : #define smt_medium      or 2,2,2
<span class="lineNum">     182 </span>                :            : #define smt_high        or 3,3,3
<span class="lineNum">     183 </span>                :            : #define smt_medium_high or 5,5,5
<span class="lineNum">     184 </span>                :            : #define smt_medium_low  or 6,6,6
<span class="lineNum">     185 </span>                :            : #define smt_extra_high  or 7,7,7
<span class="lineNum">     186 </span>                :            : #define smt_very_low    or 31,31,31
<span class="lineNum">     187 </span>                :            : 
<span class="lineNum">     188 </span>                :            : #else /* __ASSEMBLY__ */
<span class="lineNum">     189 </span>                :            : 
<span class="lineNum">     190 </span>                :            : #include &lt;compiler.h&gt;
<span class="lineNum">     191 </span>                :            : #include &lt;stdint.h&gt;
<span class="lineNum">     192 </span>                :            : 
<span class="lineNum">     193 </span>                :            : /*
<span class="lineNum">     194 </span>                :            :  * SMT priority
<span class="lineNum">     195 </span>                :            :  */
<span class="lineNum">     196 </span>                :            : 
<span class="lineNum">     197 </span>                :<span class="lineCov">   93349485 : static inline void smt_low(void)        { asm volatile(&quot;or 1,1,1&quot;);   }</span>
<span class="lineNum">     198 </span>                :<span class="lineCov">   94678377 : static inline void smt_medium(void)     { asm volatile(&quot;or 2,2,2&quot;);   }</span>
<span class="lineNum">     199 </span>                :            : static inline void smt_high(void)       { asm volatile(&quot;or 3,3,3&quot;);   }
<span class="lineNum">     200 </span>                :            : static inline void smt_medium_high(void){ asm volatile(&quot;or 5,5,5&quot;);   }
<span class="lineNum">     201 </span>                :            : static inline void smt_medium_low(void) { asm volatile(&quot;or 6,6,6&quot;);   }
<span class="lineNum">     202 </span>                :            : static inline void smt_extra_high(void) { asm volatile(&quot;or 7,7,7&quot;);   }
<span class="lineNum">     203 </span>                :<span class="lineCov">   81645294 : static inline void smt_very_low(void)   { asm volatile(&quot;or 31,31,31&quot;);        }</span>
<span class="lineNum">     204 </span>                :            : 
<span class="lineNum">     205 </span>                :            : /*
<span class="lineNum">     206 </span>                :            :  * SPR access functions
<span class="lineNum">     207 </span>                :            :  */
<span class="lineNum">     208 </span>                :            : 
<span class="lineNum">     209 </span>                :            : static inline unsigned long mfmsr(void)
<span class="lineNum">     210 </span>                :            : {
<span class="lineNum">     211 </span>                :            :         unsigned long val;
<span class="lineNum">     212 </span>                :            :         
<span class="lineNum">     213 </span>                :            :         asm volatile(&quot;mfmsr %0&quot; : &quot;=r&quot;(val) : : &quot;memory&quot;);
<span class="lineNum">     214 </span>                :            :         return val;
<span class="lineNum">     215 </span>                :            : }
<span class="lineNum">     216 </span>                :            : 
<span class="lineNum">     217 </span>                :            : static inline void mtmsr(unsigned long val)
<span class="lineNum">     218 </span>                :            : {
<span class="lineNum">     219 </span>                :            :         asm volatile(&quot;mtmsr %0&quot; : : &quot;r&quot;(val) : &quot;memory&quot;);
<span class="lineNum">     220 </span>                :            : }
<span class="lineNum">     221 </span>                :            : 
<span class="lineNum">     222 </span>                :            : static inline void mtmsrd(unsigned long val, int l)
<span class="lineNum">     223 </span>                :            : {
<span class="lineNum">     224 </span>                :            :         asm volatile(&quot;mtmsrd %0,%1&quot; : : &quot;r&quot;(val), &quot;i&quot;(l) : &quot;memory&quot;);
<span class="lineNum">     225 </span>                :            : }
<span class="lineNum">     226 </span>                :            : 
<span class="lineNum">     227 </span>                :            : static inline unsigned long mfspr(unsigned int spr)
<span class="lineNum">     228 </span>                :            : {
<span class="lineNum">     229 </span>                :            :         unsigned long val;
<span class="lineNum">     230 </span>                :            : 
<span class="lineNum">     231 </span>                :<span class="lineCov">    1674225 :         asm volatile(&quot;mfspr %0,%1&quot; : &quot;=r&quot;(val) : &quot;i&quot;(spr) : &quot;memory&quot;);</span>
<span class="lineNum">     232 </span>                :            :         return val;
<span class="lineNum">     233 </span>                :            : }
<span class="lineNum">     234 </span>                :            : 
<span class="lineNum">     235 </span>                :            : static inline void mtspr(unsigned int spr, unsigned long val)
<span class="lineNum">     236 </span>                :            : {
<span class="lineNum">     237 </span>                :<span class="lineCov">      49672 :         asm volatile(&quot;mtspr %0,%1&quot; : : &quot;i&quot;(spr), &quot;r&quot;(val) : &quot;memory&quot;);</span>
<span class="lineNum">     238 </span>                :            : }
<span class="lineNum">     239 </span>                :            : 
<span class="lineNum">     240 </span>                :            : /* Helpers for special sequences needed by some registers */
<span class="lineNum">     241 </span>                :            : extern void set_hid0(unsigned long hid0);
<span class="lineNum">     242 </span>                :            : extern void trigger_attn(void);
<span class="lineNum">     243 </span>                :            : 
<span class="lineNum">     244 </span>                :            : /*
<span class="lineNum">     245 </span>                :            :  * Barriers
<span class="lineNum">     246 </span>                :            :  */
<span class="lineNum">     247 </span>                :            : 
<span class="lineNum">     248 </span>                :            : static inline void eieio(void)
<span class="lineNum">     249 </span>                :            : {
<span class="lineNum">     250 </span>                :            :         asm volatile(&quot;eieio&quot; : : : &quot;memory&quot;);
<span class="lineNum">     251 </span>                :            : }
<span class="lineNum">     252 </span>                :            : 
<span class="lineNum">     253 </span>                :            : static inline void sync(void)
<span class="lineNum">     254 </span>                :            : {
<span class="lineNum">     255 </span>                :<span class="lineCov">    2348021 :         asm volatile(&quot;sync&quot; : : : &quot;memory&quot;);</span>
<span class="lineNum">     256 </span>                :            : }
<span class="lineNum">     257 </span>                :            : 
<span class="lineNum">     258 </span>                :            : static inline void lwsync(void)
<span class="lineNum">     259 </span>                :            : {
<span class="lineNum">     260 </span>                :<span class="lineCov">    2522705 :         asm volatile(&quot;lwsync&quot; : : : &quot;memory&quot;);</span>
<span class="lineNum">     261 </span>                :            : }
<span class="lineNum">     262 </span>                :            : 
<span class="lineNum">     263 </span>                :            : static inline void isync(void)
<span class="lineNum">     264 </span>                :            : {
<span class="lineNum">     265 </span>                :            :         asm volatile(&quot;isync&quot; : : : &quot;memory&quot;);
<span class="lineNum">     266 </span>                :            : }
<span class="lineNum">     267 </span>                :            : 
<span class="lineNum">     268 </span>                :            : 
<span class="lineNum">     269 </span>                :            : /*
<a name="270"><span class="lineNum">     270 </span>                :            :  * Cache sync</a>
<span class="lineNum">     271 </span>                :            :  */
<span class="lineNum">     272 </span>                :<span class="lineNoCov">          0 : static inline void sync_icache(void)</span>
<span class="lineNum">     273 </span>                :            : {
<span class="lineNum">     274 </span>                :<span class="lineNoCov">          0 :         asm volatile(&quot;sync; icbi 0,%0; sync; isync&quot; : : &quot;r&quot; (0) : &quot;memory&quot;);</span>
<span class="lineNum">     275 </span>                :<span class="lineNoCov">          0 : }</span>
<span class="lineNum">     276 </span>                :            : 
<span class="lineNum">     277 </span>                :            : 
<span class="lineNum">     278 </span>                :            : /*
<span class="lineNum">     279 </span>                :            :  * Byteswap load/stores
<span class="lineNum">     280 </span>                :            :  */
<span class="lineNum">     281 </span>                :            : 
<span class="lineNum">     282 </span>                :            : static inline uint16_t ld_le16(const uint16_t *addr)
<span class="lineNum">     283 </span>                :            : {
<span class="lineNum">     284 </span>                :            :         uint16_t val;
<span class="lineNum">     285 </span>                :            :         asm volatile(&quot;lhbrx %0,0,%1&quot; : &quot;=r&quot;(val) : &quot;r&quot;(addr), &quot;m&quot;(*addr));
<span class="lineNum">     286 </span>                :            :         return val;
<span class="lineNum">     287 </span>                :            : }
<span class="lineNum">     288 </span>                :            : 
<span class="lineNum">     289 </span>                :            : static inline uint32_t ld_le32(const uint32_t *addr)
<span class="lineNum">     290 </span>                :            : {
<span class="lineNum">     291 </span>                :            :         uint32_t val;
<span class="lineNum">     292 </span>                :            :         asm volatile(&quot;lwbrx %0,0,%1&quot; : &quot;=r&quot;(val) : &quot;r&quot;(addr), &quot;m&quot;(*addr));
<span class="lineNum">     293 </span>                :            :         return val;
<span class="lineNum">     294 </span>                :            : }
<span class="lineNum">     295 </span>                :            : 
<span class="lineNum">     296 </span>                :            : static inline void st_le16(uint16_t *addr, uint16_t val)
<span class="lineNum">     297 </span>                :            : {
<span class="lineNum">     298 </span>                :            :         asm volatile(&quot;sthbrx %0,0,%1&quot; : : &quot;r&quot;(val), &quot;r&quot;(addr), &quot;m&quot;(*addr));
<span class="lineNum">     299 </span>                :            : }
<span class="lineNum">     300 </span>                :            : 
<span class="lineNum">     301 </span>                :            : static inline void st_le32(uint32_t *addr, uint32_t val)
<span class="lineNum">     302 </span>                :            : {
<span class="lineNum">     303 </span>                :            :         asm volatile(&quot;stwbrx %0,0,%1&quot; : : &quot;r&quot;(val), &quot;r&quot;(addr), &quot;m&quot;(*addr));
<span class="lineNum">     304 </span>                :            : }
<span class="lineNum">     305 </span>                :            : 
<span class="lineNum">     306 </span>                :            : #endif /* __ASSEMBLY__ */
<span class="lineNum">     307 </span>                :            : 
<span class="lineNum">     308 </span>                :            : #endif /* __PROCESSOR_H */
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.9</a></td></tr>
  </table>
  <br>

</body>
</html>
