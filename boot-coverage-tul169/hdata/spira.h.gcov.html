<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - skiboot-tul169-boot.info - hdata/spira.h</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">hdata</a> - spira.h<span style="font-size: 80%;"> (source / <a href="spira.h.func.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">skiboot-tul169-boot.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">2</td>
            <td class="headerCovTableEntry">2</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2015-02-25</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">2</td>
            <td class="headerCovTableEntryLo">50.0 %</td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">           Branch data     Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>                :            : /* Copyright 2013-2014 IBM Corp.</a>
<span class="lineNum">       2 </span>                :            :  *
<span class="lineNum">       3 </span>                :            :  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
<span class="lineNum">       4 </span>                :            :  * you may not use this file except in compliance with the License.
<span class="lineNum">       5 </span>                :            :  * You may obtain a copy of the License at
<span class="lineNum">       6 </span>                :            :  *
<span class="lineNum">       7 </span>                :            :  *      http://www.apache.org/licenses/LICENSE-2.0
<span class="lineNum">       8 </span>                :            :  *
<span class="lineNum">       9 </span>                :            :  * Unless required by applicable law or agreed to in writing, software
<span class="lineNum">      10 </span>                :            :  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
<span class="lineNum">      11 </span>                :            :  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
<span class="lineNum">      12 </span>                :            :  * implied.
<span class="lineNum">      13 </span>                :            :  * See the License for the specific language governing permissions and
<span class="lineNum">      14 </span>                :            :  * limitations under the License.
<span class="lineNum">      15 </span>                :            :  */
<span class="lineNum">      16 </span>                :            : 
<span class="lineNum">      17 </span>                :            : #ifndef __SPIRA_H
<span class="lineNum">      18 </span>                :            : #define __SPIRA_H
<span class="lineNum">      19 </span>                :            : 
<span class="lineNum">      20 </span>                :            : #include &quot;hdif.h&quot;
<span class="lineNum">      21 </span>                :            : 
<span class="lineNum">      22 </span>                :            : /*
<span class="lineNum">      23 </span>                :            :  * The SPIRA structure
<span class="lineNum">      24 </span>                :            :  *
<span class="lineNum">      25 </span>                :            :  * NOTE: This is one of the only HDIF structure that we layout entirely
<span class="lineNum">      26 </span>                :            :  * as a C struct because it's provided by us to the FSP. Almost everything
<span class="lineNum">      27 </span>                :            :  * else is generated by the FSP, and thus must be &quot;parsed&quot; since the various
<span class="lineNum">      28 </span>                :            :  * offsets and alignments might change.
<span class="lineNum">      29 </span>                :            :  */
<span class="lineNum">      30 </span>                :            : 
<span class="lineNum">      31 </span>                :            : #define SPIRA_VERSION           0x20    /* Like 730 ? */
<span class="lineNum">      32 </span>                :            : 
<span class="lineNum">      33 </span>                :            : struct spira_ntuple {
<span class="lineNum">      34 </span>                :            :         __be64          addr;
<span class="lineNum">      35 </span>                :            :         __be16          alloc_cnt;
<span class="lineNum">      36 </span>                :            :         __be16          act_cnt;
<span class="lineNum">      37 </span>                :            :         __be32          alloc_len;
<span class="lineNum">      38 </span>                :            :         __be32          act_len;
<span class="lineNum">      39 </span>                :            :         __be32          tce_off;
<span class="lineNum">      40 </span>                :            :         __be64          padding;
<span class="lineNum">      41 </span>                :            : } __packed;
<span class="lineNum">      42 </span>                :            : 
<span class="lineNum">      43 </span>                :            : #define SPIRA_NTUPLES_COUNT     0x18
<span class="lineNum">      44 </span>                :            : 
<span class="lineNum">      45 </span>                :            : struct spira_ntuples {
<span class="lineNum">      46 </span>                :            :         struct HDIF_array_hdr   array_hdr;
<span class="lineNum">      47 </span>                :            :         struct spira_ntuple     sp_subsys;              /* 0x040 */
<span class="lineNum">      48 </span>                :            :         struct spira_ntuple     ipl_parms;              /* 0x060 */
<span class="lineNum">      49 </span>                :            :         struct spira_ntuple     nt_enclosure_vpd;       /* 0x080 */
<span class="lineNum">      50 </span>                :            :         struct spira_ntuple     slca;                   /* 0x0a0 */
<span class="lineNum">      51 </span>                :            :         struct spira_ntuple     backplane_vpd;          /* 0x0c0 */
<span class="lineNum">      52 </span>                :            :         struct spira_ntuple     system_vpd;             /* 0x0e0 */
<span class="lineNum">      53 </span>                :            :         struct spira_ntuple     chip_tod;               /* 0x100 */
<span class="lineNum">      54 </span>                :            :         struct spira_ntuple     proc_init;              /* 0x120 */
<span class="lineNum">      55 </span>                :            :         struct spira_ntuple     clock_vpd;              /* 0x140 */
<span class="lineNum">      56 </span>                :            :         struct spira_ntuple     anchor_vpd;             /* 0x160 */
<span class="lineNum">      57 </span>                :            :         struct spira_ntuple     op_panel_vpd;           /* 0x180 */
<span class="lineNum">      58 </span>                :            :         struct spira_ntuple     ext_cache_fru_vpd;      /* 0x1a0 */
<span class="lineNum">      59 </span>                :            :         struct spira_ntuple     misc_cec_fru_vpd;       /* 0x1c0 */
<span class="lineNum">      60 </span>                :            :         struct spira_ntuple     paca;                   /* 0x1e0 */
<span class="lineNum">      61 </span>                :            :         struct spira_ntuple     ms_vpd;                 /* 0x200 */
<span class="lineNum">      62 </span>                :            :         struct spira_ntuple     cec_iohub_fru;          /* 0x220 */
<span class="lineNum">      63 </span>                :            :         struct spira_ntuple     cpu_ctrl;               /* 0x240 */
<span class="lineNum">      64 </span>                :            :         struct spira_ntuple     mdump_src;              /* 0x260 */
<span class="lineNum">      65 </span>                :            :         struct spira_ntuple     mdump_dst;              /* 0x280 */
<span class="lineNum">      66 </span>                :            :         struct spira_ntuple     mdump_res;              /* 0x2a0 */
<span class="lineNum">      67 </span>                :            :         struct spira_ntuple     heap;                   /* 0x2c0 */
<span class="lineNum">      68 </span>                :            :         struct spira_ntuple     pcia;                   /* 0x2e0 */
<span class="lineNum">      69 </span>                :            :         struct spira_ntuple     proc_chip;              /* 0x300 */
<span class="lineNum">      70 </span>                :            :         struct spira_ntuple     hs_data;                /* 0x320 */
<span class="lineNum">      71 </span>                :            : };
<span class="lineNum">      72 </span>                :            : 
<span class="lineNum">      73 </span>                :            : struct spira {
<span class="lineNum">      74 </span>                :            :         struct HDIF_common_hdr  hdr;
<span class="lineNum">      75 </span>                :            :         struct HDIF_idata_ptr   ntuples_ptr;
<span class="lineNum">      76 </span>                :            :         __be64                  pad;
<span class="lineNum">      77 </span>                :            :         struct spira_ntuples    ntuples;
<span class="lineNum">      78 </span>                :            :         u8                      reserved[0x4c0];
<span class="lineNum">      79 </span>                :            : } __packed __align(0x100);
<span class="lineNum">      80 </span>                :            : 
<span class="lineNum">      81 </span>                :            : extern struct spira spira;
<span class="lineNum">      82 </span>                :            : 
<span class="lineNum">      83 </span>                :            : /* This macro can be used to check the validity of a pointer returned
<span class="lineNum">      84 </span>                :            :  * by one of the HDIF API functions. It returns true if the pointer
<span class="lineNum">      85 </span>                :            :  * appears valid. If it's not valid and not NULL, it will print some
<span class="lineNum">      86 </span>                :            :  * error in the log as well.
<span class="lineNum">      87 </span>                :            :  */
<span class="lineNum">      88 </span>                :            : #define CHECK_SPPTR(_ptr)       spira_check_ptr(_ptr, __FILE__, __LINE__)
<span class="lineNum">      89 </span>                :            : 
<span class="lineNum">      90 </span>                :            : #define get_hdif(ntuple, id) __get_hdif((ntuple), (id), __FILE__, __LINE__)
<span class="lineNum">      91 </span>                :            : 
<span class="lineNum">      92 </span>                :            : extern struct HDIF_common_hdr *__get_hdif(struct spira_ntuple *n,
<span class="lineNum">      93 </span>                :            :                                           const char id[],
<span class="lineNum">      94 </span>                :            :                                           const char *file, int line);
<span class="lineNum">      95 </span>                :            : 
<span class="lineNum">      96 </span>                :            : #define for_each_ntuple_idx(_ntuples, _p, _idx, _id)                    \
<span class="lineNum">      97 </span>                :            :         for (_p = get_hdif((_ntuples), _id &quot;&quot;), _idx = 0;             \
<span class="lineNum">      98 </span>                :            :              _p &amp;&amp; _idx &lt; be16_to_cpu((_ntuples)-&gt;act_cnt);               \
<span class="lineNum">      99 </span>                :            :              _p = (void *)_p + be32_to_cpu((_ntuples)-&gt;alloc_len), _idx++)
<span class="lineNum">     100 </span>                :            : 
<span class="lineNum">     101 </span>                :            : #define for_each_ntuple(_ntuples, _p, _id)                              \
<span class="lineNum">     102 </span>                :            :         for (_p = get_hdif((_ntuples), _id &quot;&quot;);                               \
<span class="lineNum">     103 </span>                :            :              _p &amp;&amp; (void *)_p &lt; ntuple_addr(_ntuples)                        \
<span class="lineNum">     104 </span>                :            :                      + (be16_to_cpu((_ntuples)-&gt;act_cnt) *           \
<span class="lineNum">     105 </span>                :            :                         be32_to_cpu((_ntuples)-&gt;alloc_len));         \
<span class="lineNum">     106 </span>                :            :              _p = (void *)_p + be32_to_cpu((_ntuples)-&gt;alloc_len))
<span class="lineNum">     107 </span>                :            : 
<span class="lineNum">     108 </span>                :            : #define for_each_paca(p) for_each_ntuple(&amp;spira.ntuples.paca, p, PACA_HDIF_SIG)
<span class="lineNum">     109 </span>                :            : 
<span class="lineNum">     110 </span>                :            : #define for_each_pcia(p) for_each_ntuple(&amp;spira.ntuples.pcia, p, SPPCIA_HDIF_SIG)
<span class="lineNum">     111 </span>                :            : 
<span class="lineNum">     112 </span>                :            : 
<span class="lineNum">     113 </span>                :            : /* We override these for testing. */
<span class="lineNum">     114 </span>                :            : #ifndef ntuple_addr
<span class="lineNum">     115 </span>                :            : #define ntuple_addr(_ntuples) ((void *)BE64_TO_CPU((_ntuples)-&gt;addr))
<span class="lineNum">     116 </span>                :            : #endif
<span class="lineNum">     117 </span>                :            : 
<span class="lineNum">     118 </span>                :            : #ifndef spira_check_ptr
<span class="lineNum">     119 </span>                :            : extern bool spira_check_ptr(const void *ptr, const char *file,
<span class="lineNum">     120 </span>                :            :                             unsigned int line);
<span class="lineNum">     121 </span>                :            : #endif
<span class="lineNum">     122 </span>                :            : 
<span class="lineNum">     123 </span>                :            : struct proc_init_data {
<span class="lineNum">     124 </span>                :            :         struct HDIF_common_hdr  hdr;
<span class="lineNum">     125 </span>                :            :         struct HDIF_idata_ptr   regs_ptr;
<span class="lineNum">     126 </span>                :            :         struct {
<span class="lineNum">     127 </span>                :            :                 __be64  nia;
<span class="lineNum">     128 </span>                :            :                 __be64  msr;
<span class="lineNum">     129 </span>                :            :         } regs;
<span class="lineNum">     130 </span>                :            : } __packed __align(0x10);
<span class="lineNum">     131 </span>                :            : 
<span class="lineNum">     132 </span>                :            : /*
<span class="lineNum">     133 </span>                :            :  * The FRU ID structure is used in several tuples, so we
<span class="lineNum">     134 </span>                :            :  * define it generically here
<span class="lineNum">     135 </span>                :            :  */
<span class="lineNum">     136 </span>                :            : struct spira_fru_id {
<span class="lineNum">     137 </span>                :            :         __be16          slca_index;
<span class="lineNum">     138 </span>                :            :         __be16          rsrc_id;        /* formerly VPD port number */
<span class="lineNum">     139 </span>                :            : };
<span class="lineNum">     140 </span>                :            : 
<span class="lineNum">     141 </span>                :            : /*
<span class="lineNum">     142 </span>                :            :  * The FRU operational status structure is used in several
<span class="lineNum">     143 </span>                :            :  * tuples, so we define it generically here
<span class="lineNum">     144 </span>                :            :  */
<span class="lineNum">     145 </span>                :            : struct spira_fru_op_status {
<span class="lineNum">     146 </span>                :            :         uint8_t flags;
<span class="lineNum">     147 </span>                :            : #define FRU_OP_STATUS_FLAG_USED         0x02 /* If 0 -&gt; not used (redundant) */
<span class="lineNum">     148 </span>                :            : #define FRU_OP_STATUS_FLAG_FUNCTIONAL   0x01 /* If 0 -&gt; non-functional */
<span class="lineNum">     149 </span>                :            :         uint8_t reserved[3];
<span class="lineNum">     150 </span>                :            : };
<span class="lineNum">     151 </span>                :            : 
<span class="lineNum">     152 </span>                :            : /*
<span class="lineNum">     153 </span>                :            :  * Move VPD related stuff to another file ...
<span class="lineNum">     154 </span>                :            :  */
<span class="lineNum">     155 </span>                :            : #define VPD_ID(_a, _b)  ((_a) &lt;&lt; 8 | (_b))
<span class="lineNum">     156 </span>                :            : 
<span class="lineNum">     157 </span>                :            : /*
<span class="lineNum">     158 </span>                :            :  * Service Processor Subsystem Structure
<span class="lineNum">     159 </span>                :            :  *
<span class="lineNum">     160 </span>                :            :  * This structure contains several internal data blocks
<span class="lineNum">     161 </span>                :            :  * describing the service processor(s) in the system
<span class="lineNum">     162 </span>                :            :  */
<span class="lineNum">     163 </span>                :            : 
<span class="lineNum">     164 </span>                :            : #define SPSS_HDIF_SIG   &quot;SPINFO&quot;
<span class="lineNum">     165 </span>                :            : 
<span class="lineNum">     166 </span>                :            : /* Idata index 0 : FRU ID Data */
<span class="lineNum">     167 </span>                :            : #define SPSS_IDATA_FRU_ID       0
<span class="lineNum">     168 </span>                :            : 
<span class="lineNum">     169 </span>                :            : /* Idata index 1 : Keyword VPD for the FSP instance */
<span class="lineNum">     170 </span>                :            : #define SPSS_IDATA_KEYWORD_VPD  1
<span class="lineNum">     171 </span>                :            : 
<span class="lineNum">     172 </span>                :            : /* Idata index 2 : SP Implementation */
<span class="lineNum">     173 </span>                :            : #define SPSS_IDATA_SP_IMPL      2
<span class="lineNum">     174 </span>                :            : 
<span class="lineNum">     175 </span>                :            : struct spss_sp_impl {
<span class="lineNum">     176 </span>                :            :         __be16  hw_version;
<span class="lineNum">     177 </span>                :            :         __be16  sw_version;
<span class="lineNum">     178 </span>                :            :         __be16  func_flags;
<span class="lineNum">     179 </span>                :            : #define SPSS_SP_IMPL_FLAGS_INSTALLED    0x8000
<span class="lineNum">     180 </span>                :            : #define SPSS_SP_IMPL_FLAGS_FUNCTIONAL   0x4000
<span class="lineNum">     181 </span>                :            : #define SPSS_SP_IMPL_FLAGS_PRIMARY      0x2000
<span class="lineNum">     182 </span>                :            :         u8      chip_version;
<span class="lineNum">     183 </span>                :            :         u8      reserved;
<span class="lineNum">     184 </span>                :            : };
<span class="lineNum">     185 </span>                :            : 
<span class="lineNum">     186 </span>                :            : /* Idata index 3 is deprecated */
<span class="lineNum">     187 </span>                :            : 
<span class="lineNum">     188 </span>                :            : /* Idata index 4 : SP Memory Locator */
<span class="lineNum">     189 </span>                :            : #define SPSS_IDATA_SP_MEMLOC    4
<span class="lineNum">     190 </span>                :            : 
<span class="lineNum">     191 </span>                :            : /* Idata index 5 : SP I/O path array */
<span class="lineNum">     192 </span>                :            : #define SPSS_IDATA_SP_IOPATH    5
<span class="lineNum">     193 </span>                :            : 
<span class="lineNum">     194 </span>                :            : /* An HDIF array of IO path */
<span class="lineNum">     195 </span>                :            : struct spss_iopath {
<span class="lineNum">     196 </span>                :            :         __be16  iopath_type;
<span class="lineNum">     197 </span>                :            : #define SPSS_IOPATH_TYPE_IOHUB_PHB      0x0001
<span class="lineNum">     198 </span>                :            : #define SPSS_IOPATH_TYPE_PSI            0x0002
<span class="lineNum">     199 </span>                :            :         union {
<span class="lineNum">     200 </span>                :            :                 struct {
<span class="lineNum">     201 </span>                :            :                         __be16  iohub_chip_inst;
<span class="lineNum">     202 </span>                :            :                         __be16  iohub_chip_port;
<span class="lineNum">     203 </span>                :            :                         __be16  phb_id;
<span class="lineNum">     204 </span>                :            :                 } __packed iohub_phb;
<span class="lineNum">     205 </span>                :            : 
<span class="lineNum">     206 </span>                :            :                 struct {
<span class="lineNum">     207 </span>                :            :                         __be16  link_status;
<span class="lineNum">     208 </span>                :            : #define SPSS_IO_PATH_PSI_LINK_BAD_FRU   0x0000
<span class="lineNum">     209 </span>                :            : #define SPSS_IO_PATH_PSI_LINK_CURRENT   0x0001
<span class="lineNum">     210 </span>                :            : #define SPSS_IO_PATH_PSI_LINK_BACKUP    0x0002
<span class="lineNum">     211 </span>                :            :                         u8      ml2_version;
<span class="lineNum">     212 </span>                :            :                         u8      reserved;
<span class="lineNum">     213 </span>                :            :                         __be16  slca_count;
<span class="lineNum">     214 </span>                :            :                         u8      slca_idx[16];
<span class="lineNum">     215 </span>                :            :                         __be32  proc_chip_id;
<span class="lineNum">     216 </span>                :            :                         __be32  reserved2;
<span class="lineNum">     217 </span>                :            :                         __be64  gxhb_base;
<span class="lineNum">     218 </span>                :            :                 } __packed psi;
<span class="lineNum">     219 </span>                :            :         };
<span class="lineNum">     220 </span>                :            : } __packed;
<span class="lineNum">     221 </span>                :            : 
<span class="lineNum">     222 </span>                :            : /*
<span class="lineNum">     223 </span>                :            :  * IPL Parms structure
<span class="lineNum">     224 </span>                :            :  *
<span class="lineNum">     225 </span>                :            :  */
<span class="lineNum">     226 </span>                :            : 
<span class="lineNum">     227 </span>                :            : /* Idata index 0: System Parameters */
<span class="lineNum">     228 </span>                :            : #define IPLPARAMS_SYSPARAMS     0
<span class="lineNum">     229 </span>                :            : 
<span class="lineNum">     230 </span>                :            : struct iplparams_sysparams {
<span class="lineNum">     231 </span>                :            :         char            sys_model[4];
<span class="lineNum">     232 </span>                :            :         char            cpu_feature_code[4];
<span class="lineNum">     233 </span>                :            :         __be32          effective_pvr;
<span class="lineNum">     234 </span>                :            :         __be32          system_type;
<span class="lineNum">     235 </span>                :            :         uint8_t         num_lpar_oct[8];
<span class="lineNum">     236 </span>                :            :         __be32          abc_bus_speed;
<span class="lineNum">     237 </span>                :            :         __be32          wxyz_bus_speed;
<span class="lineNum">     238 </span>                :            :         __be32          sys_eco_mode;
<span class="lineNum">     239 </span>                :            :         __be32          sys_attributes;
<span class="lineNum">     240 </span>                :            :         __be32          mem_scrubbing;
<span class="lineNum">     241 </span>                :            :         __be16          cur_spl_value;
<span class="lineNum">     242 </span>                :            :         uint8_t         pump_mode;
<span class="lineNum">     243 </span>                :            :         uint8_t         use_pore_sleep;
<span class="lineNum">     244 </span>                :            :         __be32          pore_image_size;
<span class="lineNum">     245 </span>                :            : } __packed;
<span class="lineNum">     246 </span>                :            : 
<span class="lineNum">     247 </span>                :            : /* Idata index 1: IPL parameters */
<span class="lineNum">     248 </span>                :            : #define IPLPARAMS_IPLPARAMS     1
<span class="lineNum">     249 </span>                :            : 
<span class="lineNum">     250 </span>                :            : struct iplparams_iplparams {
<span class="lineNum">     251 </span>                :            :         uint8_t         reserved;
<span class="lineNum">     252 </span>                :            :         uint8_t         hv_ipl_dest;
<span class="lineNum">     253 </span>                :            :         uint8_t         ipl_side;
<span class="lineNum">     254 </span>                :            : #define IPLPARAMS_CEC_FW_IPL_SIDE_TEMP  0x10
<span class="lineNum">     255 </span>                :            : #define IPLPARAMS_FSP_FW_IPL_SIDE_TEMP  0x01
<span class="lineNum">     256 </span>                :            :         uint8_t         ipl_speed;
<span class="lineNum">     257 </span>                :            :         __be16          cec_ipl_attrib;
<span class="lineNum">     258 </span>                :            :         uint8_t         cec_ipl_maj_type;
<span class="lineNum">     259 </span>                :            :         uint8_t         cec_ipl_min_type;
<span class="lineNum">     260 </span>                :            :         uint8_t         os_ipl_mode;
<span class="lineNum">     261 </span>                :            :         uint8_t         keylock_pos;
<span class="lineNum">     262 </span>                :            :         uint8_t         lmb_size;
<span class="lineNum">     263 </span>                :            :         uint8_t         deprecated;
<span class="lineNum">     264 </span>                :            :         __be32          max_hsl_opticonnect;
<span class="lineNum">     265 </span>                :            :         __be32          other_attrib;
<span class="lineNum">     266 </span>                :            : #define IPLPARAMS_OATTR_RST_PCI_BUSNO   0x08000000
<span class="lineNum">     267 </span>                :            : #define IPLPARAMS_OATTR_CLEAR_NVRAM     0x04000000
<span class="lineNum">     268 </span>                :            :         __be16          huge_page_count;
<span class="lineNum">     269 </span>                :            :         uint8_t         huge_page_size;
<span class="lineNum">     270 </span>                :            : #define IPLPARAMS_HUGE_PG_SIZE_16G      0
<span class="lineNum">     271 </span>                :            :         uint8_t         num_vlan_switches;
<span class="lineNum">     272 </span>                :            :         __be64          reserved2;
<span class="lineNum">     273 </span>                :            : };
<span class="lineNum">     274 </span>                :            : 
<span class="lineNum">     275 </span>                :            : /* Idata index 4: Platform Dump Descriptor */
<span class="lineNum">     276 </span>                :            : #define IPLPARAMS_PLATFORM_DUMP         4
<span class="lineNum">     277 </span>                :            : 
<span class="lineNum">     278 </span>                :            : struct iplparams_dump {
<span class="lineNum">     279 </span>                :            :         __be16  flags;
<span class="lineNum">     280 </span>                :            :         uint8_t reserved1;
<span class="lineNum">     281 </span>                :            :         uint8_t policy;
<span class="lineNum">     282 </span>                :            : #define HYP_DUMP_POLICY_NORMAL  0x00
<span class="lineNum">     283 </span>                :            :         __be32  dump_id;
<span class="lineNum">     284 </span>                :            :         __be64  reserved2;
<span class="lineNum">     285 </span>                :            :         __be64  act_dump_sz;
<span class="lineNum">     286 </span>                :            :         __be32  max_hw_dump_sz;
<span class="lineNum">     287 </span>                :            :         __be32  act_hw_dump_sz;
<span class="lineNum">     288 </span>                :            :         __be32  max_sp_dump_sz;
<span class="lineNum">     289 </span>                :            :         __be32  plid;
<span class="lineNum">     290 </span>                :            : };
<span class="lineNum">     291 </span>                :            : 
<span class="lineNum">     292 </span>                :            : /* Idata index 8: serial ports */
<span class="lineNum">     293 </span>                :            : #define IPLPARMS_IDATA_SERIAL   8
<span class="lineNum">     294 </span>                :            : 
<span class="lineNum">     295 </span>                :            : /* An HDIF array of serial descriptions */
<span class="lineNum">     296 </span>                :            : struct iplparms_serial {
<span class="lineNum">     297 </span>                :            :         uint8_t         loc_code[LOC_CODE_SIZE];
<span class="lineNum">     298 </span>                :            :         __be16          rsrc_id;
<span class="lineNum">     299 </span>                :            :         __be16          flags;
<span class="lineNum">     300 </span>                :            : #define PLPARMS_SERIAL_FLAGS_CALLHOME   0x8000
<span class="lineNum">     301 </span>                :            : } __packed;
<span class="lineNum">     302 </span>                :            : 
<span class="lineNum">     303 </span>                :            : /*
<span class="lineNum">     304 </span>                :            :  * Chip TOD structure
<span class="lineNum">     305 </span>                :            :  *
<span class="lineNum">     306 </span>                :            :  * This is an array of 32 entries (I assume per possible chip)
<span class="lineNum">     307 </span>                :            :  */
<span class="lineNum">     308 </span>                :            : 
<span class="lineNum">     309 </span>                :            : /* Idata index 0: Chip ID data (array) */
<span class="lineNum">     310 </span>                :            : #define CHIPTOD_IDATA_CHIPID    0
<span class="lineNum">     311 </span>                :            : 
<span class="lineNum">     312 </span>                :            : struct chiptod_chipid {
<span class="lineNum">     313 </span>                :            :         __be32          chip_id;
<span class="lineNum">     314 </span>                :            :         __be32          flags;
<span class="lineNum">     315 </span>                :            : #define CHIPTOD_ID_FLAGS_PRIMARY        0x02
<span class="lineNum">     316 </span>                :            : #define CHIPTOD_ID_FLAGS_SECONDARY      0x01
<span class="lineNum">     317 </span>                :            : #define CHIPTOD_ID_FLAGS_STATUS_MASK    0x0c
<span class="lineNum">     318 </span>                :            : #define CHIPTOD_ID_FLAGS_STATUS_OK      0x04
<span class="lineNum">     319 </span>                :            : #define CHIPTOD_ID_FLAGS_STATUS_NOK     0x08
<span class="lineNum">     320 </span>                :            : } __packed;
<span class="lineNum">     321 </span>                :            : 
<span class="lineNum">     322 </span>                :            : /* Idata index 0: Chip Initialization data */
<span class="lineNum">     323 </span>                :            : #define CHIPTOD_IDATA_CHIPINIT  1
<span class="lineNum">     324 </span>                :            : 
<span class="lineNum">     325 </span>                :            : struct chiptod_chipinit {
<span class="lineNum">     326 </span>                :            :         __be32          ctrl_reg_internal;
<span class="lineNum">     327 </span>                :            :         __be32          tod_ctrl_reg;
<span class="lineNum">     328 </span>                :            : } __packed;
<span class="lineNum">     329 </span>                :            : 
<span class="lineNum">     330 </span>                :            : /*
<span class="lineNum">     331 </span>                :            :  * MS VPD - Memory Description Tree
<span class="lineNum">     332 </span>                :            :  *
<span class="lineNum">     333 </span>                :            :  * One such structure pointing to the various memory arrays
<span class="lineNum">     334 </span>                :            :  * along with other infos about the BCRs, Page Mover, XSCOM,...
<span class="lineNum">     335 </span>                :            :  */
<span class="lineNum">     336 </span>                :            : #define MSVPD_HDIF_SIG  &quot;MS VPD&quot;
<span class="lineNum">     337 </span>                :            : 
<span class="lineNum">     338 </span>                :            : /* Idata index 0: Mainstore address config */
<span class="lineNum">     339 </span>                :            : #define MSVPD_IDATA_MS_ADDR_CONFIG      0
<span class="lineNum">     340 </span>                :            : 
<span class="lineNum">     341 </span>                :            : /* Mainstore Address Configuration */
<span class="lineNum">     342 </span>                :            : struct msvpd_ms_addr_config {
<span class="lineNum">     343 </span>                :            :         __be64   max_configured_ms_address;
<span class="lineNum">     344 </span>                :            :         __be64   max_possible_ms_address;
<span class="lineNum">     345 </span>                :            :         __be32   deprecated;
<span class="lineNum">     346 </span>                :            :         __be64   mirrorable_memory_starting_address;
<span class="lineNum">     347 </span>                :            : } __attribute__((packed));
<span class="lineNum">     348 </span>                :            : 
<span class="lineNum">     349 </span>                :            : /* Idata index 1: Total configured mainstore */
<span class="lineNum">     350 </span>                :            : #define MSVPD_IDATA_TOTAL_CONFIG_MS     1
<span class="lineNum">     351 </span>                :            : 
<span class="lineNum">     352 </span>                :            : struct msvpd_total_config_ms {
<span class="lineNum">     353 </span>                :            :         __be64   total_in_mb;
<span class="lineNum">     354 </span>                :            : };
<span class="lineNum">     355 </span>                :            : 
<span class="lineNum">     356 </span>                :            : /* Idata index 2: Page mover and sync structure */
<span class="lineNum">     357 </span>                :            : #define MSVPD_IDATA_PMOVER_SYNCHRO      2
<span class="lineNum">     358 </span>                :            : 
<span class="lineNum">     359 </span>                :            : struct msvpd_pmover_bsr_synchro {
<span class="lineNum">     360 </span>                :            :         __be32          flags;
<span class="lineNum">     361 </span>                :            : #define MSVPD_PMS_FLAG_HWLOCK_EN        0x80000000
<span class="lineNum">     362 </span>                :            : #define MSVPD_PMS_FLAG_PMOVER_EN        0x40000000
<span class="lineNum">     363 </span>                :            : #define MSVPD_PMS_FLAG_BSR_EN           0x20000000
<span class="lineNum">     364 </span>                :            : #define MSVPD_PMS_FLAG_XSCOMBASE_VALID  0x10000000
<span class="lineNum">     365 </span>                :            :         /* P7 values for BSR mode */
<span class="lineNum">     366 </span>                :            : #define MSVPD_PMS_FLAG_P7BSR_1M_MODE    0x00000000
<span class="lineNum">     367 </span>                :            : #define MSVPD_PMS_FLAG_P7BSR_2M_MODE    0x02000000
<span class="lineNum">     368 </span>                :            : #define MSVPD_PMS_FLAG_P7BSR_4M_MODE    0x04000000
<span class="lineNum">     369 </span>                :            : #define MSVPD_PMS_FLAG_P7BSR_8M_MODE    0x06000000
<span class="lineNum">     370 </span>                :            :         __be32          hwlocks_per_page;
<span class="lineNum">     371 </span>                :            :         __be64          hwlock_addr;
<span class="lineNum">     372 </span>                :            :         __be64          pmover_addr;
<span class="lineNum">     373 </span>                :            :         __be64          bsr_addr;
<span class="lineNum">     374 </span>                :            :         __be64          xscom_addr;
<span class="lineNum">     375 </span>                :            : 
<span class="lineNum">     376 </span>                :            : };
<span class="lineNum">     377 </span>                :            : 
<span class="lineNum">     378 </span>                :            : /* Idata index 3: Memory Trace Array */
<span class="lineNum">     379 </span>                :            : 
<span class="lineNum">     380 </span>                :            : /* Idata index 4: UE Address Array */
<span class="lineNum">     381 </span>                :            : 
<span class="lineNum">     382 </span>                :            : /* Child index 0: MS area child structure */
<span class="lineNum">     383 </span>                :            : #define MSVPD_CHILD_MS_AREAS            0
<span class="lineNum">     384 </span>                :            : 
<span class="lineNum">     385 </span>                :            : /*
<span class="lineNum">     386 </span>                :            :  * CEC I/O Hub FRU
<span class="lineNum">     387 </span>                :            :  *
<span class="lineNum">     388 </span>                :            :  * This is an array of CEC Hub FRU HDIF structures
<span class="lineNum">     389 </span>                :            :  *
<span class="lineNum">     390 </span>                :            :  * Each of these has some idata pointers to generic info about the
<span class="lineNum">     391 </span>                :            :  * hub and a possible child pointer for daughter card.
<span class="lineNum">     392 </span>                :            :  *
<span class="lineNum">     393 </span>                :            :  * Actual ports are in the SLCA and need to be cross referenced
<span class="lineNum">     394 </span>                :            :  *
<span class="lineNum">     395 </span>                :            :  * Note that slots meant for the addition of GX+ adapters that
<span class="lineNum">     396 </span>                :            :  * are currently unpopulated but support hotplug will have a
<span class="lineNum">     397 </span>                :            :  * minimum &quot;placeholder&quot; entry, which will be fully populated
<span class="lineNum">     398 </span>                :            :  * when the array is rebuild during concurrent maintainance.
<span class="lineNum">     399 </span>                :            :  * This &quot;placeholder&quot; is called a &quot;reservation&quot;.
<span class="lineNum">     400 </span>                :            :  *
<span class="lineNum">     401 </span>                :            :  * WARNING: The array rebuild by concurrent maintainance is not
<span class="lineNum">     402 </span>                :            :  * guaranteed to be in the same order as the IPL array, not is
<span class="lineNum">     403 </span>                :            :  * the order stable between concurrent maintainance operations.
<span class="lineNum">     404 </span>                :            :  *
<span class="lineNum">     405 </span>                :            :  * There's also a child pointer to daugher card structures but
<span class="lineNum">     406 </span>                :            :  * we aren't going to handle that just yet.
<span class="lineNum">     407 </span>                :            :  */
<span class="lineNum">     408 </span>                :            : #define CECHUB_FRU_HDIF_SIG     &quot;IO HUB&quot;
<span class="lineNum">     409 </span>                :            : #define IOKID_FRU_HDIF_SIG      &quot;IO KID&quot;
<span class="lineNum">     410 </span>                :            : 
<span class="lineNum">     411 </span>                :            : /* Idata index 0: FRU ID data
<span class="lineNum">     412 </span>                :            :  *
<span class="lineNum">     413 </span>                :            :  * This is a generic struct spira_fru_id defined above
<span class="lineNum">     414 </span>                :            :  */
<span class="lineNum">     415 </span>                :            : #define CECHUB_FRU_ID_DATA              0
<span class="lineNum">     416 </span>                :            : 
<span class="lineNum">     417 </span>                :            : /* Idata index 1: ASCII Keyword VPD */
<span class="lineNum">     418 </span>                :            : #define CECHUB_ASCII_KEYWORD_VPD        1
<span class="lineNum">     419 </span>                :            : 
<span class="lineNum">     420 </span>                :            : /* Idata index 2: Hub FRU ID data area */
<span class="lineNum">     421 </span>                :            : #define CECHUB_FRU_ID_DATA_AREA         2
<span class="lineNum">     422 </span>                :            : 
<span class="lineNum">     423 </span>                :            : struct cechub_hub_fru_id {
<span class="lineNum">     424 </span>                :            :         __be32          card_type;
<span class="lineNum">     425 </span>                :            : #define CECHUB_FRU_TYPE_IOHUB_RSRV      0
<span class="lineNum">     426 </span>                :            : #define CECHUB_FRU_TYPE_IOHUB_CARD      1
<span class="lineNum">     427 </span>                :            : #define CECHUB_FRU_TYPE_CPU_CARD        2
<span class="lineNum">     428 </span>                :            : #define CECHUB_FRU_TYPE_CEC_BKPLANE     3
<span class="lineNum">     429 </span>                :            : #define CECHUB_FRU_TYPE_BKPLANE_EXT     4
<span class="lineNum">     430 </span>                :            :         __be32          unused;
<span class="lineNum">     431 </span>                :            :         __be16          total_chips;
<span class="lineNum">     432 </span>                :            :         uint8_t         flags;
<span class="lineNum">     433 </span>                :            : #define CECHUB_FRU_FLAG_HEADLESS        0x80 /* not connected to CPU */
<span class="lineNum">     434 </span>                :            : #define CECHUB_FRU_FLAG_PASSTHROUGH     0x40 /* connected to passhtrough
<span class="lineNum">     435 </span>                :            :                                                 port of another hub */
<span class="lineNum">     436 </span>                :            :         uint8_t         reserved;
<span class="lineNum">     437 </span>                :            :         __be16          parent_hub_id;  /* chip instance number of the
<span class="lineNum">     438 </span>                :            :                                            hub that contains the passthrough
<span class="lineNum">     439 </span>                :            :                                            port this one is connected to */
<span class="lineNum">     440 </span>                :            :         __be16          reserved2;
<span class="lineNum">     441 </span>                :            : } __packed;
<span class="lineNum">     442 </span>                :            : 
<span class="lineNum">     443 </span>                :            : 
<span class="lineNum">     444 </span>                :            : /* Idata index 3: IO HUB array */
<span class="lineNum">     445 </span>                :            : 
<span class="lineNum">     446 </span>                :            : #define CECHUB_FRU_IO_HUBS              3
<span class="lineNum">     447 </span>                :            : 
<span class="lineNum">     448 </span>                :            : /* This is an HDIF array of IO Hub structures */
<span class="lineNum">     449 </span>                :            : struct cechub_io_hub {
<span class="lineNum">     450 </span>                :            :         __be64          fmtc_address;
<span class="lineNum">     451 </span>                :            :         __be32          fmtc_tce_size;
<span class="lineNum">     452 </span>                :            :         __be16          hub_num;        /* unique hub number (I/O Hub ID) */
<span class="lineNum">     453 </span>                :            :         uint8_t         flags;
<span class="lineNum">     454 </span>                :            : #define CECHUB_HUB_FLAG_STATE_MASK      0xc0
<span class="lineNum">     455 </span>                :            : #define CECHUB_HUB_FLAG_STATE_OK        0x00
<span class="lineNum">     456 </span>                :            : #define CECHUB_HUB_FLAG_STATE_FAILURES  0x40
<span class="lineNum">     457 </span>                :            : #define CECHUB_HUB_FLAG_STATE_NOT_INST  0x80
<span class="lineNum">     458 </span>                :            : #define CECHUB_HUB_FLAG_STATE_UNUSABLE  0xc0
<span class="lineNum">     459 </span>                :            : #define CECHUB_HUB_FLAG_MASTER_HUB      0x20 /* HDAT &lt; v9.x only */
<span class="lineNum">     460 </span>                :            : #define CECHUB_HUB_FLAG_GARD_MASK_VALID 0x08 /* HDAT &lt; v9.x only */
<span class="lineNum">     461 </span>                :            : #define CECHUB_HUB_FLAG_SWITCH_MASK_PDT 0x04 /* HDAT &lt; v9.x only */
<span class="lineNum">     462 </span>                :            : #define CECHUB_HUB_FLAG_FAB_BR0_PDT     0x02 /* HDAT &lt; v9.x only */
<span class="lineNum">     463 </span>                :            : #define CECHUB_HUB_FLAG_FAB_BR1_PDT     0x01 /* HDAT &lt; v9.x only */
<span class="lineNum">     464 </span>                :            :         uint8_t         nr_ports;            /* HDAT &lt; v9.x only */
<span class="lineNum">     465 </span>                :            :         uint8_t         fab_br0_pdt;    /* p5ioc2 PCI-X or P8 PHB3's */
<span class="lineNum">     466 </span>                :            : #define CECHUB_HUB_FAB_BR0_PDT_PHB0     0x80
<span class="lineNum">     467 </span>                :            : #define CECHUB_HUB_FAB_BR0_PDT_PHB1     0x40
<span class="lineNum">     468 </span>                :            : #define CECHUB_HUB_FAB_BR0_PDT_PHB2     0x20
<span class="lineNum">     469 </span>                :            : #define CECHUB_HUB_FAB_BR0_PDT_PHB3     0x10
<span class="lineNum">     470 </span>                :            :         uint8_t         fab_br1_pdt;    /* p5ioc2 &amp; p7ioc PCI-E */
<span class="lineNum">     471 </span>                :            : #define CECHUB_HUB_FAB_BR1_PDT_PHB0     0x80
<span class="lineNum">     472 </span>                :            : #define CECHUB_HUB_FAB_BR1_PDT_PHB1     0x40
<span class="lineNum">     473 </span>                :            : #define CECHUB_HUB_FAB_BR1_PDT_PHB2     0x20
<span class="lineNum">     474 </span>                :            : #define CECHUB_HUB_FAB_BR1_PDT_PHB3     0x10
<span class="lineNum">     475 </span>                :            : #define CECHUB_HUB_FAB_BR1_PDT_PHB4     0x08 /* p7ioc only */
<span class="lineNum">     476 </span>                :            : #define CECHUB_HUB_FAB_BR1_PDT_PHB5     0x04 /* p7ioc only */
<span class="lineNum">     477 </span>                :            :         __be16          iohub_id;       /* the type of hub */
<span class="lineNum">     478 </span>                :            : #define CECHUB_HUB_P5IOC2       0x1061  /* from VPL1 */
<span class="lineNum">     479 </span>                :            : #define CECHUB_HUB_P7IOC        0x60e7  /* from VPL3 */
<span class="lineNum">     480 </span>                :            : #define CECHUB_HUB_MURANO       0x20ef  /* Murano from spec */
<span class="lineNum">     481 </span>                :            : #define CECHUB_HUB_MURANO_SEGU  0x0001  /* Murano+Seguso from spec */
<span class="lineNum">     482 </span>                :            : #define CECHUB_HUB_VENICE_WYATT 0x0010  /* Venice+Wyatt from spec */
<span class="lineNum">     483 </span>                :            :         __be32          ec_level;
<span class="lineNum">     484 </span>                :            :         __be32          aff_dom2;       /* HDAT &lt; v9.x only */
<span class="lineNum">     485 </span>                :            :         __be32          aff_dom3;       /* HDAT &lt; v9.x only */
<span class="lineNum">     486 </span>                :            :         __be64          reserved;
<span class="lineNum">     487 </span>                :            :         __be32          proc_chip_id;
<span class="lineNum">     488 </span>                :            : 
<span class="lineNum">     489 </span>                :            :         union {
<span class="lineNum">     490 </span>                :            :                 /* HDAT &lt; v9.x */
<span class="lineNum">     491 </span>                :            :                 struct {
<span class="lineNum">     492 </span>                :            :                         __be32          gx_index;       /* GX bus index on cpu */
<span class="lineNum">     493 </span>                :            :                         __be32          buid_ext;       /* BUID Extension */
<span class="lineNum">     494 </span>                :            :                         __be32          xscom_chip_id;  /* TORRENT ONLY */
<span class="lineNum">     495 </span>                :            :                 };
<span class="lineNum">     496 </span>                :            :                 /* HDAT &gt;= v9.x */
<span class="lineNum">     497 </span>                :            :                 struct {
<span class="lineNum">     498 </span>                :            :                         __be32          reserved1;
<span class="lineNum">     499 </span>                :            :                         __be32          reserved2;
<span class="lineNum">     500 </span>                :            :                         __be16          reserved3;
<span class="lineNum">     501 </span>                :            :                         __be16          hw_topology;
<span class="lineNum">     502 </span>                :            :                 };
<span class="lineNum">     503 </span>                :            :         };
<span class="lineNum">     504 </span>                :            :         __be32          mrid;
<span class="lineNum">     505 </span>                :            :         __be32          mem_map_vers;
<span class="lineNum">     506 </span>                :            :         union {
<span class="lineNum">     507 </span>                :            :                 /* HDAT &lt; v9.x */
<span class="lineNum">     508 </span>                :            :                 struct {
<span class="lineNum">     509 </span>                :            :                         __be64          gx_ctrl_bar0;
<span class="lineNum">     510 </span>                :            :                         __be64          gx_ctrl_bar1;
<span class="lineNum">     511 </span>                :            :                         __be64          gx_ctrl_bar2;
<span class="lineNum">     512 </span>                :            :                         __be64          gx_ctrl_bar3;
<span class="lineNum">     513 </span>                :            :                         __be64          gx_ctrl_bar4;
<span class="lineNum">     514 </span>                :            :                         __be32          sw_mask_pdt;
<span class="lineNum">     515 </span>                :            :                         __be16          gard_mask;
<span class="lineNum">     516 </span>                :            :                         __be16          gx_bus_speed;   /* Version 0x58 */
<span class="lineNum">     517 </span>                :            :                 };
<span class="lineNum">     518 </span>                :            : 
<span class="lineNum">     519 </span>                :            :                 /* HDAT &gt;= v9.x, HDIF version 0x6A or later */
<span class="lineNum">     520 </span>                :            :                 struct {
<span class="lineNum">     521 </span>                :            :                         /* 4 values per PHB, 4 PHBs */
<span class="lineNum">     522 </span>                :            :                         __be64          phb_lane_eq[4][4];
<span class="lineNum">     523 </span>                :            :                 };
<span class="lineNum">     524 </span>                :            :         };
<span class="lineNum">     525 </span>                :            : } __packed;
<span class="lineNum">     526 </span>                :            : 
<span class="lineNum">     527 </span>                :            : /* We support structures as small as 0x68 bytes */
<span class="lineNum">     528 </span>                :            : #define CECHUB_IOHUB_MIN_SIZE   0x68
<span class="lineNum">     529 </span>                :            : 
<span class="lineNum">     530 </span>                :            : /* Child index 0: IO Daugther Card */
<span class="lineNum">     531 </span>                :            : #define CECHUB_CHILD_IO_KIDS            0
<span class="lineNum">     532 </span>                :            : 
<span class="lineNum">     533 </span>                :            : /*
<span class="lineNum">     534 </span>                :            :  * IO KID is a dauther card structure
<span class="lineNum">     535 </span>                :            :  */
<span class="lineNum">     536 </span>                :            : #define IOKID_FRU_ID_DATA       0
<span class="lineNum">     537 </span>                :            : #define IOKID_KW_VPD            1
<span class="lineNum">     538 </span>                :            : 
<span class="lineNum">     539 </span>                :            : /*
<span class="lineNum">     540 </span>                :            :  * CPU Controls Legacy Structure
<span class="lineNum">     541 </span>                :            :  */
<span class="lineNum">     542 </span>                :            : struct cpu_ctl_legacy {
<span class="lineNum">     543 </span>                :            :         __be64 addr;
<span class="lineNum">     544 </span>                :            :         __be64 size;
<span class="lineNum">     545 </span>                :            : } __packed;
<span class="lineNum">     546 </span>                :            : 
<span class="lineNum">     547 </span>                :            : /*
<span class="lineNum">     548 </span>                :            :  * CPU Control Legacy table
<span class="lineNum">     549 </span>                :            :  *
<span class="lineNum">     550 </span>                :            :  * Format of this table is defined in FIPS PHYP Attn spec.
<span class="lineNum">     551 </span>                :            :  */
<span class="lineNum">     552 </span>                :            : struct cpu_ctl_legacy_table {
<span class="lineNum">     553 </span>                :            :         struct cpu_ctl_legacy spat;
<span class="lineNum">     554 </span>                :            :         struct cpu_ctl_legacy sp_attn_area1;
<span class="lineNum">     555 </span>                :            :         struct cpu_ctl_legacy sp_attn_area2;
<span class="lineNum">     556 </span>                :            :         struct cpu_ctl_legacy hsr_area;
<span class="lineNum">     557 </span>                :            :         struct cpu_ctl_legacy reserved[12];
<span class="lineNum">     558 </span>                :            : } __packed;
<span class="lineNum">     559 </span>                :            : 
<span class="lineNum">     560 </span>                :            : /*
<span class="lineNum">     561 </span>                :            :  * CPU Controls Header Structure
<span class="lineNum">     562 </span>                :            :  */
<span class="lineNum">     563 </span>                :            : #define CPU_CTL_HDIF_SIG        &quot;CPUCTL&quot;
<span class="lineNum">     564 </span>                :            : struct cpu_ctl_init_data {
<span class="lineNum">     565 </span>                :            :         struct HDIF_common_hdr          hdr;
<span class="lineNum">     566 </span>                :            :         struct HDIF_idata_ptr           cpu_ctl;
<span class="lineNum">     567 </span>                :            :         uint8_t                         reserved[8];
<span class="lineNum">     568 </span>                :            :         struct cpu_ctl_legacy_table     cpu_ctl_lt;
<span class="lineNum">     569 </span>                :            : } __packed __align(0x10);
<span class="lineNum">     570 </span>                :            : 
<span class="lineNum">     571 </span>                :            : /*
<span class="lineNum">     572 </span>                :            :  * Slot Location Code Array (aka SLCA)
<span class="lineNum">     573 </span>                :            :  *
<span class="lineNum">     574 </span>                :            :  * This is a pile of location codes referenced by various other
<span class="lineNum">     575 </span>                :            :  * structures such as the IO Hubs for things on the CEC. Not
<span class="lineNum">     576 </span>                :            :  * everything in there is a physical port. The SLCA is actually
<span class="lineNum">     577 </span>                :            :  * a tree which represent the topology of the system.
<span class="lineNum">     578 </span>                :            :  *
<span class="lineNum">     579 </span>                :            :  * The tree works as follow: A parent has a pointer to the first
<span class="lineNum">     580 </span>                :            :  * child. A child has a pointer to its parent. Siblings are
<span class="lineNum">     581 </span>                :            :  * consecutive entries.
<span class="lineNum">     582 </span>                :            :  *
<span class="lineNum">     583 </span>                :            :  * Note: If we ever support concurrent maintainance... this is
<span class="lineNum">     584 </span>                :            :  * completely rebuilt, invalidating all indices, though other
<span class="lineNum">     585 </span>                :            :  * structures that may reference SLCA by index will be rebuilt
<span class="lineNum">     586 </span>                :            :  * as well.
<span class="lineNum">     587 </span>                :            :  *
<span class="lineNum">     588 </span>                :            :  * Note that a lot of that stuff is based on VPD documentation
<span class="lineNum">     589 </span>                :            :  * such as the identification keywords. I will list the ones
<span class="lineNum">     590 </span>                :            :  * I manage to figure out without the doc separately.
<span class="lineNum">     591 </span>                :            :  */
<span class="lineNum">     592 </span>                :            : #define SLCA_HDIF_SIG   &quot;SLCA  &quot;
<span class="lineNum">     593 </span>                :            : 
<span class="lineNum">     594 </span>                :            : /* Idata index 0 : SLCA root pointer
<span class="lineNum">     595 </span>                :            :  *
<span class="lineNum">     596 </span>                :            :  * The SLCA array is an HDIF array of all the entries. The tree
<span class="lineNum">     597 </span>                :            :  * structure is based on indices inside the entries and order of
<span class="lineNum">     598 </span>                :            :  * the entries
<span class="lineNum">     599 </span>                :            :  */
<span class="lineNum">     600 </span>                :            : #define SLCA_IDATA_ARRAY        0
<span class="lineNum">     601 </span>                :            : 
<span class="lineNum">     602 </span>                :            : #define SLCA_ROOT_INDEX         0
<span class="lineNum">     603 </span>                :            : 
<span class="lineNum">     604 </span>                :            : /* Note: An &quot;index&quot; (or idx) is always an index into the SLCA array
<span class="lineNum">     605 </span>                :            :  * and &quot;id&quot; is a reference to some other object.
<span class="lineNum">     606 </span>                :            :  */
<span class="lineNum">     607 </span>                :            : struct slca_entry {
<span class="lineNum">     608 </span>                :            :         __be16          my_index;       /* redundant, useful */
<span class="lineNum">     609 </span>                :            :         __be16          rsrc_id;        /* formerly VPD port number */
<span class="lineNum">     610 </span>                :            :         uint8_t         fru_id[2];      /* ASCII VPD ID */
<span class="lineNum">     611 </span>                :            : #define SLCA_ROOT_VPD_ID        VPD_ID('V','V')
<span class="lineNum">     612 </span>                :            : #define SLCA_SYSTEM_VPD_ID      VPD_ID('S','V')
<span class="lineNum">     613 </span>                :            :         __be16          parent_index;   /* Parent entry index */
<span class="lineNum">     614 </span>                :            :         uint8_t         flags;
<span class="lineNum">     615 </span>                :            : #define SLCA_FLAG_NON_FUNCTIONAL        0x02    /* For redundant entries */
<span class="lineNum">     616 </span>                :            : #define SLCA_FLAG_IMBEDDED              0x01    /* not set =&gt; pluggable */
<span class="lineNum">     617 </span>                :            :         uint8_t         old_nr_child;   /* Legacy: Nr of children */
<span class="lineNum">     618 </span>                :            :         __be16          child_index;    /* First child index */
<span class="lineNum">     619 </span>                :            :         __be16          child_rsrc_id;  /* Resource ID of first child */
<span class="lineNum">     620 </span>                :            :         uint8_t         loc_code_allen; /* Alloc len of loc code */
<span class="lineNum">     621 </span>                :            :         uint8_t         loc_code_len;   /* Loc code len */
<span class="lineNum">     622 </span>                :            :         uint8_t         loc_code[LOC_CODE_SIZE]; /* NULL terminated (thus max 79 chr) */
<span class="lineNum">     623 </span>                :            :         __be16          first_dup_idx;  /* First redundant resource index */
<span class="lineNum">     624 </span>                :            :         uint8_t         nr_dups;        /* Number of redundant entries */
<span class="lineNum">     625 </span>                :            :         uint8_t         reserved;
<span class="lineNum">     626 </span>                :            :         __be16          nr_child;       /* New version */
<span class="lineNum">     627 </span>                :            :         uint8_t         install_indic;  /* Installed indicator */
<span class="lineNum">     628 </span>                :            : #define SLCA_INSTALL_NO_HW_PDT          1 /* No HW presence detect */
<span class="lineNum">     629 </span>                :            : #define SLCA_INSTALL_INSTALLED          2
<span class="lineNum">     630 </span>                :            : #define SLCA_INSTALL_NOT_INSTALLED      3
<span class="lineNum">     631 </span>                :            :         uint8_t         vpd_collected;
<span class="lineNum">     632 </span>                :            : #define SLCA_VPD_COLLECTED              2
<span class="lineNum">     633 </span>                :            : #define SLCA_VPD_NOT_COLLECTED          3
<span class="lineNum">     634 </span>                :            : } __packed;
<span class="lineNum">     635 </span>                :            : 
<span class="lineNum">     636 </span>                :            : /*
<span class="lineNum">     637 </span>                :            :  * System VPD
<span class="lineNum">     638 </span>                :            :  */
<span class="lineNum">     639 </span>                :            : #define SYSVPD_HDIF_SIG &quot;SYSVPD&quot;
<span class="lineNum">     640 </span>                :            : 
<span class="lineNum">     641 </span>                :            : /* Idata index 0 : FRU ID Data */
<span class="lineNum">     642 </span>                :            : #define SYSVPD_IDATA_FRU_ID     0
<span class="lineNum">     643 </span>                :            : 
<span class="lineNum">     644 </span>                :            : /* Idata index 1 : Keyword VPD */
<span class="lineNum">     645 </span>                :            : #define SYSVPD_IDATA_KW_VPD     1
<span class="lineNum">     646 </span>                :            : 
<span class="lineNum">     647 </span>                :            : /* Idata index 2 : Operational status */
<span class="lineNum">     648 </span>                :            : #define SYSVPD_IDATA_OP_STATUS  2
<span class="lineNum">     649 </span>                :            : 
<span class="lineNum">     650 </span>                :            : /*
<span class="lineNum">     651 </span>                :            :  * FRU keyword VPD structure
<span class="lineNum">     652 </span>                :            :  */
<span class="lineNum">     653 </span>                :            : #define FRUVPD_HDIF_SIG &quot;FRUVPD&quot;
<span class="lineNum">     654 </span>                :            : 
<span class="lineNum">     655 </span>                :            : /* Idata index 0 : FRU ID Data */
<span class="lineNum">     656 </span>                :            : #define FRUVPD_IDATA_FRU_ID     0
<span class="lineNum">     657 </span>                :            : 
<span class="lineNum">     658 </span>                :            : /* Idata index 1 : Keyword VPD */
<span class="lineNum">     659 </span>                :            : #define FRUVPD_IDATA_KW_VPD     1
<span class="lineNum">     660 </span>                :            : 
<span class="lineNum">     661 </span>                :            : /* Idata index 2 : Operational status */
<span class="lineNum">     662 </span>                :            : #define FRUVPD_IDATA_OP_STATUS  2
<span class="lineNum">     663 </span>                :            : 
<span class="lineNum">     664 </span>                :            : 
<span class="lineNum">     665 </span>                :            : /*
<span class="lineNum">     666 </span>                :            :  * SPPACA structure. The SPIRA contain an array of these, one
<span class="lineNum">     667 </span>                :            :  * per processor thread
<span class="lineNum">     668 </span>                :            :  */
<span class="lineNum">     669 </span>                :            : #define PACA_HDIF_SIG   &quot;SPPACA&quot;
<span class="lineNum">     670 </span>                :            : 
<span class="lineNum">     671 </span>                :            : /* Idata index 0 : FRU ID Data */
<span class="lineNum">     672 </span>                :            : #define SPPACA_IDATA_FRU_ID     0
<span class="lineNum">     673 </span>                :            : 
<span class="lineNum">     674 </span>                :            : /* Idata index 1 : Keyword VPD */
<span class="lineNum">     675 </span>                :            : #define SPPACA_IDATA_KW_VPD     1
<span class="lineNum">     676 </span>                :            : 
<span class="lineNum">     677 </span>                :            : /* Idata index 2 : CPU ID data area */
<span class="lineNum">     678 </span>                :            : #define SPPACA_IDATA_CPU_ID     2
<span class="lineNum">     679 </span>                :            : 
<span class="lineNum">     680 </span>                :            : struct sppaca_cpu_id {
<span class="lineNum">     681 </span>                :            :         __be32 pir;
<span class="lineNum">     682 </span>                :            :         __be32 fru_id;
<span class="lineNum">     683 </span>                :            :         __be32 hardware_proc_id;
<span class="lineNum">     684 </span>                :            : #define CPU_ID_VERIFY_MASK                      0xC0000000
<span class="lineNum">     685 </span>                :            : #define CPU_ID_VERIFY_SHIFT                     30
<span class="lineNum">     686 </span>                :            : #define CPU_ID_VERIFY_USABLE_NO_FAILURES        0
<span class="lineNum">     687 </span>                :            : #define CPU_ID_VERIFY_USABLE_FAILURES           1
<span class="lineNum">     688 </span>                :            : #define CPU_ID_VERIFY_NOT_INSTALLED             2
<span class="lineNum">     689 </span>                :            : #define CPU_ID_VERIFY_UNUSABLE                  3
<span class="lineNum">     690 </span>                :            : #define CPU_ID_SECONDARY_THREAD                 0x20000000
<span class="lineNum">     691 </span>                :            : #define CPU_ID_PACA_RESERVED                    0x10000000
<span class="lineNum">     692 </span>                :            : #define CPU_ID_NUM_SECONDARY_THREAD_MASK        0x00FF0000
<span class="lineNum">     693 </span>                :            : #define CPU_ID_NUM_SECONDARY_THREAD_SHIFT       16
<span class="lineNum">     694 </span>                :            :         __be32 verify_exists_flags;
<span class="lineNum">     695 </span>                :            :         __be32 chip_ec_level;
<span class="lineNum">     696 </span>                :            :         __be32 processor_chip_id;
<span class="lineNum">     697 </span>                :            :         __be32 logical_processor_id;
<span class="lineNum">     698 </span>                :            :         /* This is the resource number, too. */
<span class="lineNum">     699 </span>                :            :         __be32 process_interrupt_line;
<span class="lineNum">     700 </span>                :            :         __be32 reserved1;
<span class="lineNum">     701 </span>                :            :         __be32 hardware_module_id;
<span class="lineNum">     702 </span>                :            :         __be64 ibase;
<span class="lineNum">     703 </span>                :            :         __be32 deprecated1;
<span class="lineNum">     704 </span>                :            :         __be32 physical_thread_id;
<span class="lineNum">     705 </span>                :            :         __be32 deprecated2;
<span class="lineNum">     706 </span>                :            :         __be32 ccm_node_id;
<span class="lineNum">     707 </span>                :            :         /* This fields are not always present, check struct size */
<span class="lineNum">     708 </span>                :            : #define SPIRA_CPU_ID_MIN_SIZE   0x40
<span class="lineNum">     709 </span>                :            :         __be32 hw_card_id;
<span class="lineNum">     710 </span>                :            :         __be32 internal_drawer_node_id;
<span class="lineNum">     711 </span>                :            :         __be32 drawer_book_octant_blade_id;
<span class="lineNum">     712 </span>                :            :         __be32 memory_interleaving_scope;
<span class="lineNum">     713 </span>                :            :         __be32 lco_target;
<span class="lineNum">     714 </span>                :            : } __packed;
<span class="lineNum">     715 </span>                :            : 
<span class="lineNum">     716 </span>                :            : /* Idata index 3 : Timebase data */
<span class="lineNum">     717 </span>                :            : #define SPPACA_IDATA_TIMEBASE   3
<span class="lineNum">     718 </span>                :            : 
<span class="lineNum">     719 </span>                :            : struct sppaca_cpu_timebase {
<span class="lineNum">     720 </span>                :            :         __be32 cycle_time;
<span class="lineNum">     721 </span>                :            :         __be32 time_base;
<span class="lineNum">     722 </span>                :            :         __be32 actual_clock_speed;
<span class="lineNum">     723 </span>                :            :         __be32 memory_bus_frequency;
<span class="lineNum">     724 </span>                :            : } __packed;
<span class="lineNum">     725 </span>                :            : 
<span class="lineNum">     726 </span>                :            : /* Idata index 4 : Cache size structure */
<span class="lineNum">     727 </span>                :            : #define SPPACA_IDATA_CACHE_SIZE 4
<span class="lineNum">     728 </span>                :            : 
<span class="lineNum">     729 </span>                :            : struct sppaca_cpu_cache {
<span class="lineNum">     730 </span>                :            :         __be32 icache_size_kb;
<span class="lineNum">     731 </span>                :            :         __be32 icache_line_size;
<span class="lineNum">     732 </span>                :            :         __be32 l1_dcache_size_kb;
<span class="lineNum">     733 </span>                :            :         __be32 l1_dcache_line_size;
<span class="lineNum">     734 </span>                :            :         __be32 l2_dcache_size_kb;
<span class="lineNum">     735 </span>                :            :         __be32 l2_line_size;
<span class="lineNum">     736 </span>                :            :         __be32 l3_dcache_size_kb;
<span class="lineNum">     737 </span>                :            :         __be32 l3_line_size;
<span class="lineNum">     738 </span>                :            :         __be32 dcache_block_size;
<span class="lineNum">     739 </span>                :            :         __be32 icache_block_size;
<span class="lineNum">     740 </span>                :            :         __be32 dcache_assoc_sets;
<span class="lineNum">     741 </span>                :            :         __be32 icache_assoc_sets;
<span class="lineNum">     742 </span>                :            :         __be32 dtlb_entries;
<span class="lineNum">     743 </span>                :            :         __be32 dtlb_assoc_sets;
<span class="lineNum">     744 </span>                :            :         __be32 itlb_entries;
<span class="lineNum">     745 </span>                :            :         __be32 itlb_assoc_sets;
<span class="lineNum">     746 </span>                :            :         __be32 reservation_size;
<span class="lineNum">     747 </span>                :            :         __be32 l2_cache_assoc_sets;
<span class="lineNum">     748 </span>                :            :         __be32 l35_dcache_size_kb;
<span class="lineNum">     749 </span>                :            :         __be32 l35_cache_line_size;
<span class="lineNum">     750 </span>                :            : };
<span class="lineNum">     751 </span>                :            : 
<span class="lineNum">     752 </span>                :            : /* Idata index 6 : CPU Attributes */
<span class="lineNum">     753 </span>                :            : #define SPPACA_IDATA_CPU_ATTR   6
<span class="lineNum">     754 </span>                :            : 
<span class="lineNum">     755 </span>                :            : #define sppaca_cpu_attr sppcia_cpu_attr
<span class="lineNum">     756 </span>                :            : 
<span class="lineNum">     757 </span>                :            : /*
<span class="lineNum">     758 </span>                :            :  * SPPCIA structure. The SPIRA contain an array of these, one
<span class="lineNum">     759 </span>                :            :  * per processor core
<span class="lineNum">     760 </span>                :            :  */
<span class="lineNum">     761 </span>                :            : #define SPPCIA_HDIF_SIG &quot;SPPCIA&quot;
<span class="lineNum">     762 </span>                :            : 
<span class="lineNum">     763 </span>                :            : /* Idata index 0 : Core unique data */
<span class="lineNum">     764 </span>                :            : #define SPPCIA_IDATA_CORE_UNIQUE        0
<span class="lineNum">     765 </span>                :            : 
<span class="lineNum">     766 </span>                :            : /* NOTE: This is the same layout as &quot;struct sppaca_cpu_id&quot;,
<span class="lineNum">     767 </span>                :            :  *       with essentially some fields removed and a reserved
<span class="lineNum">     768 </span>                :            :  *       field added
<span class="lineNum">     769 </span>                :            :  */
<span class="lineNum">     770 </span>                :            : struct sppcia_core_unique {
<span class="lineNum">     771 </span>                :            :         __be32 reserved;
<span class="lineNum">     772 </span>                :            :         __be32 proc_fru_id;
<span class="lineNum">     773 </span>                :            :         __be32 hw_proc_id;
<span class="lineNum">     774 </span>                :            :         __be32 verif_exist_flags;       /* Same as PACA */
<span class="lineNum">     775 </span>                :            :         __be32 chip_ec_level;
<span class="lineNum">     776 </span>                :            :         __be32 proc_chip_id;
<span class="lineNum">     777 </span>                :            :         __be32 reserved2;
<span class="lineNum">     778 </span>                :            :         __be32 reserved3;
<span class="lineNum">     779 </span>                :            :         __be32 reserved4;
<span class="lineNum">     780 </span>                :            :         __be32 hw_module_id;
<span class="lineNum">     781 </span>                :            :         __be64 reserved5;
<span class="lineNum">     782 </span>                :            :         __be32 reserved6;
<span class="lineNum">     783 </span>                :            :         __be32 reserved7;
<span class="lineNum">     784 </span>                :            :         __be32 reserved8;
<span class="lineNum">     785 </span>                :            :         __be32 ccm_node_id;
<span class="lineNum">     786 </span>                :            :         __be32 hw_card_id;
<span class="lineNum">     787 </span>                :            :         __be32 internal_drawer_node_id;
<span class="lineNum">     788 </span>                :            :         __be32 drawer_book_octant_blade_id;
<span class="lineNum">     789 </span>                :            :         __be32 memory_interleaving_scope;
<span class="lineNum">     790 </span>                :            :         __be32 lco_target;
<span class="lineNum">     791 </span>                :            :         __be32 reserved9;
<span class="lineNum">     792 </span>                :            : } __packed;
<span class="lineNum">     793 </span>                :            : 
<span class="lineNum">     794 </span>                :            : /* Idata index 1 : CPU Time base structure */
<span class="lineNum">     795 </span>                :            : #define SPPCIA_IDATA_TIMEBASE           1
<span class="lineNum">     796 </span>                :            : 
<span class="lineNum">     797 </span>                :            : #define sppcia_cpu_timebase sppaca_cpu_timebase
<span class="lineNum">     798 </span>                :            : 
<span class="lineNum">     799 </span>                :            : /* Idata index 2 : CPU Cache Size Structure */
<span class="lineNum">     800 </span>                :            : #define SPPCIA_IDATA_CPU_CACHE          2
<span class="lineNum">     801 </span>                :            : 
<span class="lineNum">     802 </span>                :            : #define sppcia_cpu_cache sppaca_cpu_cache
<span class="lineNum">     803 </span>                :            : 
<span class="lineNum">     804 </span>                :            : /* Idata index 3 : Thread Array Data
<span class="lineNum">     805 </span>                :            :  *
<span class="lineNum">     806 </span>                :            :  * HDIF array of
<span class="lineNum">     807 </span>                :            :  */
<span class="lineNum">     808 </span>                :            : #define SPPCIA_IDATA_THREAD_ARRAY       3
<span class="lineNum">     809 </span>                :            : 
<span class="lineNum">     810 </span>                :            : struct sppcia_cpu_thread {
<span class="lineNum">     811 </span>                :            :         __be32 proc_int_line;
<span class="lineNum">     812 </span>                :            :         __be32 phys_thread_id;
<span class="lineNum">     813 </span>                :            :         __be64 ibase;
<span class="lineNum">     814 </span>                :            :         __be32 pir;
<span class="lineNum">     815 </span>                :            : } __packed;
<span class="lineNum">     816 </span>                :            : 
<span class="lineNum">     817 </span>                :            : /* Idata index 4 : CPU Attributes */
<span class="lineNum">     818 </span>                :            : #define SPPCIA_IDATA_CPU_ATTR           4
<span class="lineNum">     819 </span>                :            : 
<span class="lineNum">     820 </span>                :            : struct sppcia_cpu_attr {
<span class="lineNum">     821 </span>                :            : #define CPU_ATTR_UNIFIED_PL1    0x80
<span class="lineNum">     822 </span>                :            : #define CPU_ATTR_SPLIT_TLB      0x40
<span class="lineNum">     823 </span>                :            : #define CPU_ATTR_TLBIA          0x20
<span class="lineNum">     824 </span>                :            : #define CPU_ATTR_PERF_MONITOR   0x10
<span class="lineNum">     825 </span>                :            : #define CPU_ATTR_EXTERN_CONT    0x02
<span class="lineNum">     826 </span>                :            :         __be32 attr;
<span class="lineNum">     827 </span>                :            : } __packed;
<span class="lineNum">     828 </span>                :            : 
<span class="lineNum">     829 </span>                :            : /*
<span class="lineNum">     830 </span>                :            :  * Processor Chip Related Data. The SPIRA contain an array of these, one
<span class="lineNum">     831 </span>                :            :  * per chip
<span class="lineNum">     832 </span>                :            :  */
<span class="lineNum">     833 </span>                :            : #define SPPCRD_HDIF_SIG &quot;SPPCRD&quot;
<span class="lineNum">     834 </span>                :            : 
<span class="lineNum">     835 </span>                :            : /* Idata index 0 : Chip info */
<span class="lineNum">     836 </span>                :            : #define SPPCRD_IDATA_CHIP_INFO  0
<span class="lineNum">     837 </span>                :            : 
<span class="lineNum">     838 </span>                :            : struct sppcrd_chip_info {
<span class="lineNum">     839 </span>                :            :         __be32 proc_chip_id;
<span class="lineNum">     840 </span>                :            :         __be32 verif_exist_flags;
<span class="lineNum">     841 </span>                :            : #define CHIP_VERIFY_MASK                        0xC0000000
<span class="lineNum">     842 </span>                :            : #define CHIP_VERIFY_SHIFT                       30
<span class="lineNum">     843 </span>                :            : #define CHIP_VERIFY_USABLE_NO_FAILURES          0
<span class="lineNum">     844 </span>                :            : #define CHIP_VERIFY_USABLE_FAILURES             1
<span class="lineNum">     845 </span>                :            : #define CHIP_VERIFY_NOT_INSTALLED               2
<span class="lineNum">     846 </span>                :            : #define CHIP_VERIFY_UNUSABLE                    3
<span class="lineNum">     847 </span>                :            :         __be32 nx_state;
<span class="lineNum">     848 </span>                :            :         __be32 pore_state;
<span class="lineNum">     849 </span>                :            :         __be32 xscom_id;
<span class="lineNum">     850 </span>                :            :         /* Version 0xA */
<span class="lineNum">     851 </span>                :            :         __be32 reserved;
<span class="lineNum">     852 </span>                :            :         __be32 dbob_id;
<span class="lineNum">     853 </span>                :            :         __be32 occ_state;
<span class="lineNum">     854 </span>                :            : } __packed;
<span class="lineNum">     855 </span>                :            : 
<span class="lineNum">     856 </span>                :            : /* Idata index 1 : Chip TOD */
<span class="lineNum">     857 </span>                :            : #define SPPCRD_IDATA_CHIP_TOD   1
<span class="lineNum">     858 </span>                :            : 
<span class="lineNum">     859 </span>                :            : struct sppcrd_chip_tod {
<span class="lineNum">     860 </span>                :            :         __be32 flags;
<span class="lineNum">     861 </span>                :            :         /* CHIPTOD_ID_... values */
<span class="lineNum">     862 </span>                :            :         __be32 ctrl_reg_internal;
<span class="lineNum">     863 </span>                :            :         __be32 tod_ctrl_reg;
<span class="lineNum">     864 </span>                :            : } __packed;
<span class="lineNum">     865 </span>                :            : 
<span class="lineNum">     866 </span>                :            : /* Idata index 2 : FRU ID */
<span class="lineNum">     867 </span>                :            : #define SPPCRD_IDATA_FRU_ID     2
<span class="lineNum">     868 </span>                :            : 
<span class="lineNum">     869 </span>                :            : /* Idata index 3 : ASCII Keyword data */
<span class="lineNum">     870 </span>                :            : #define SPPCRD_IDATA_KW_VPD     3
<span class="lineNum">     871 </span>                :            : 
<span class="lineNum">     872 </span>                :            : /* Idata index 4 : Module VPD */
<span class="lineNum">     873 </span>                :            : #define SPPCRD_IDATA_MODULE_VPD 4
<span class="lineNum">     874 </span>                :            : 
<span class="lineNum">     875 </span>                :            : 
<span class="lineNum">     876 </span>                :            : /*
<span class="lineNum">     877 </span>                :            :  * Host Services Data.
<span class="lineNum">     878 </span>                :            :  */
<span class="lineNum">     879 </span>                :            : #define HSERV_HDIF_SIG  &quot;HOSTSR&quot;
<span class="lineNum">     880 </span>                :            : 
<span class="lineNum">     881 </span>                :            : /* Idata index 0 : System attribute data */
<a name="882"><span class="lineNum">     882 </span>                :            : #define HSERV_IDATA_SYS_ATTR    0</a>
<span class="lineNum">     883 </span>                :            : 
<span class="lineNum">     884 </span>                :<span class="lineCov">          4 : static inline const char *cpu_state(u32 flags)</span>
<span class="lineNum">     885 </span>                :            : {
<span class="lineNum">     886 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">          4 :         switch ((flags &amp; CPU_ID_VERIFY_MASK) &gt;&gt; CPU_ID_VERIFY_SHIFT) {</span>
<span class="lineNum">     887 </span>                :            :         case CPU_ID_VERIFY_USABLE_NO_FAILURES:
<span class="lineNum">     888 </span>                :            :                 return &quot;OK&quot;;
<span class="lineNum">     889 </span>                :            :         case CPU_ID_VERIFY_USABLE_FAILURES:
<span class="lineNum">     890 </span>                :            :                 return &quot;FAILURES&quot;;
<span class="lineNum">     891 </span>                :            :         case CPU_ID_VERIFY_NOT_INSTALLED:
<span class="lineNum">     892 </span>                :            :                 return &quot;NOT-INSTALLED&quot;;
<span class="lineNum">     893 </span>                :            :         case CPU_ID_VERIFY_UNUSABLE:
<span class="lineNum">     894 </span>                :            :                 return &quot;UNUSABLE&quot;;
<span class="lineNum">     895 </span>                :            :         }
<span class="lineNum">     896 </span>                :            :         return &quot;**UNKNOWN**&quot;;
<span class="lineNum">     897 </span>                :            : }
<span class="lineNum">     898 </span>                :            : #endif /* __SPIRA_H */
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.9</a></td></tr>
  </table>
  <br>

</body>
</html>
